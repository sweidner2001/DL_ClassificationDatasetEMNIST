cat  /home/c611/output_FinalModelTrainingTest_cc.out
nohup: Eingabe wird ignoriert
2025-06-26 14:33:16.868876: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1750941196.885415   81252 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1750941196.890470   81252 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-06-26 14:33:16.908045: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Länge: 697932
---rebalance_test_from_train()---
100%|██████████| 36/36 [00:00<00:00, 1408.56it/s]
100%|██████████| 36/36 [00:00<00:00, 6419.31it/s]
Prepare Test-Dataset: 100%|██████████| 36/36 [00:00<00:00, 379.43label/s]
Klasse 0: Test 1000 - original Test 5778
Klasse 1: Test 1000 - original Test 6330
Klasse 2: Test 1000 - original Test 5869
Klasse 3: Test 1000 - original Test 5969
Klasse 4: Test 1000 - original Test 5619
Klasse 5: Test 1000 - original Test 5190
Klasse 6: Test 1000 - original Test 5705
Klasse 7: Test 1000 - original Test 6139
Klasse 8: Test 1000 - original Test 5633
Klasse 9: Test 1000 - original Test 5686
Klasse A: Test 1000 - original Test 1062
Klasse B: Test 648 - Train 352
Klasse C: Test 1000 - original Test 1739
Klasse D: Test 779 - Train 221
Klasse E: Test 851 - Train 149
Klasse F: Test 1000 - original Test 1440
Klasse G: Test 447 - Train 553
Klasse H: Test 521 - Train 479
Klasse I: Test 1000 - original Test 2048
Klasse J: Test 626 - Train 374
Klasse K: Test 382 - Train 618
Klasse L: Test 810 - Train 190
Klasse M: Test 1000 - original Test 1485
Klasse a: Test 1000 - original Test 1644
Klasse b: Test 853 - Train 147
Klasse c: Test 432 - Train 568
Klasse d: Test 1000 - original Test 1683
Klasse e: Test 1000 - original Test 4092
Klasse f: Test 400 - Train 600
Klasse g: Test 589 - Train 411
Klasse h: Test 1000 - original Test 1479
Klasse i: Test 427 - Train 573
Klasse j: Test 317 - Train 683
Klasse k: Test 466 - Train 534
Klasse l: Test 1000 - original Test 2535
Klasse m: Test 464 - Train 536
Länge danch: 507942
100%|██████████| 36/36 [00:00<00:00, 2302.00it/s]
Prepare Train-Dataset: 100%|██████████| 36/36 [00:00<00:00, 87.83label/s]
Label 0: Train 5000 orig 5000
Trainingsdaten nach Label 0: 5000
Label 1: Train 5000 orig 5000
Trainingsdaten nach Label 1: 10000
Label 2: Train 5000 orig 5000
Trainingsdaten nach Label 2: 15000
Label 3: Train 5000 orig 5000
Trainingsdaten nach Label 3: 20000
Label 4: Train 5000 orig 5000
Trainingsdaten nach Label 4: 25000
Label 5: Train 5000 orig 5000
Trainingsdaten nach Label 5: 30000
Label 6: Train 5000 orig 5000
Trainingsdaten nach Label 6: 35000
Label 7: Train 5000 orig 5000
Trainingsdaten nach Label 7: 40000
Label 8: Train 5000 orig 5000
Trainingsdaten nach Label 8: 45000
Label 9: Train 5000 orig 5000
Trainingsdaten nach Label 9: 50000
Label A: Train 5000 orig 5000
Trainingsdaten nach Label A: 55000
Label B: Train 3526 augmentated 1474
Trainingsdaten nach Label B: 60000
Label C: Train 5000 orig 5000
Trainingsdaten nach Label C: 65000
Label D: Train 4341 augmentated 659
Trainingsdaten nach Label D: 70000
Label E: Train 4785 augmentated 215
Trainingsdaten nach Label E: 75000
Label F: Train 5000 orig 5000
Trainingsdaten nach Label F: 80000
Label G: Train 1964 augmentated 3036
Trainingsdaten nach Label G: 85000
Label H: Train 2673 augmentated 2327
Trainingsdaten nach Label H: 90000
Label I: Train 5000 orig 5000
Trainingsdaten nach Label I: 95000
Label J: Train 3388 augmentated 1612
Trainingsdaten nach Label J: 100000
Label K: Train 1850 augmentated 3150
Trainingsdaten nach Label K: 105000
Label L: Train 4886 augmentated 114
Trainingsdaten nach Label L: 110000
Label M: Train 5000 orig 5000
Trainingsdaten nach Label M: 115000
Label a: Train 5000 orig 5000
Trainingsdaten nach Label a: 120000
Label b: Train 5000 orig 5000
Trainingsdaten nach Label b: 125000
Label c: Train 2286 augmentated 2714
Trainingsdaten nach Label c: 130000
Label d: Train 5000 orig 5000
Trainingsdaten nach Label d: 135000
Label e: Train 5000 orig 5000
Trainingsdaten nach Label e: 140000
Label f: Train 1961 augmentated 3039
Trainingsdaten nach Label f: 145000
Label g: Train 3276 augmentated 1724
Trainingsdaten nach Label g: 150000
Label h: Train 5000 orig 5000
Trainingsdaten nach Label h: 155000
Label i: Train 2152 augmentated 2848
Trainingsdaten nach Label i: 160000
Label j: Train 1213 augmentated 3787
Trainingsdaten nach Label j: 165000
Label k: Train 1957 augmentated 3043
Trainingsdaten nach Label k: 170000
Label l: Train 5000 orig 5000
Trainingsdaten nach Label l: 175000
Label m: Train 2109 augmentated 2891
Trainingsdaten nach Label m: 180000
{'lr': 3.825472731975857e-05, 'weight_decay': 0.000469, 'num_epochs': 13, 'batch_size': 32, 'only_train_classifier': False, 'sched_patience': 5, 'sched_factor': 0.442897, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': True, 'probabilities': [1, 1, 1], 'config_CombinedClassifier': {'conv2d_out_1': 64, 'conv2d_kernel_size_1': 5, 'conv2d_out_2': 64, 'conv2d_kernel_size_2': 3, 'conv2d_out_3': 32, 'conv2d_kernel_size_3': 3, 'linear_out_1': 128, 'linear_out_2': 32, 'dropout': 0.32}}


-------------- Start New Training: ---------------


Epoch 1/13: 100%|██████████| 4500/4500 [01:42<00:00, 44.09batch/s, loss=3.2716, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:18<00:00, 59.62batch/s]
top1_score    0.353485
top3_score    0.360368
top5_score    0.362581
dtype: float64
valid_loss:  3.2594827766418457
Learning rate after epoch 1: [3.825472731975857e-05]
top1_score    0.353485
top3_score    0.360368
top5_score    0.362581
dtype: float64

            best_value  on_step
top1_score    0.353485        0
top3_score    0.360368        0
top5_score    0.362581        0
Epoch 2/13: 100%|██████████| 4500/4500 [01:40<00:00, 44.98batch/s, loss=3.2816, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:18<00:00, 59.27batch/s]
top1_score    0.355372
top3_score    0.361425
top5_score    0.364584
dtype: float64
valid_loss:  3.2566860336727568
Learning rate after epoch 2: [3.825472731975857e-05]
top1_score    0.355372
top3_score    0.361425
top5_score    0.364584
dtype: float64

            best_value  on_step
top1_score    0.355372        1
top3_score    0.361425        1
top5_score    0.364584        1
Epoch 3/13: 100%|██████████| 4500/4500 [01:41<00:00, 44.12batch/s, loss=3.2002, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:19<00:00, 59.19batch/s]
top1_score    0.411605
top3_score    0.422889
top5_score    0.435019
dtype: float64
valid_loss:  3.206574119144016
Learning rate after epoch 3: [3.825472731975857e-05]
top1_score    0.411605
top3_score    0.422889
top5_score    0.435019
dtype: float64

            best_value  on_step
top1_score    0.411605        2
top3_score    0.422889        2
top5_score    0.435019        2
Epoch 4/13: 100%|██████████| 4500/4500 [01:41<00:00, 44.16batch/s, loss=3.0642, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:18<00:00, 59.33batch/s]
top1_score    0.593018
top3_score    0.612596
top5_score    0.618963
dtype: float64
valid_loss:  3.0666765944163004
Learning rate after epoch 4: [3.825472731975857e-05]
top1_score    0.593018
top3_score    0.612596
top5_score    0.618963
dtype: float64

            best_value  on_step
top1_score    0.593018        3
top3_score    0.612596        3
top5_score    0.618963        3
Epoch 5/13: 100%|██████████| 4500/4500 [01:41<00:00, 44.28batch/s, loss=3.0515, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:18<00:00, 61.33batch/s]
top1_score    0.608210
top3_score    0.624813
top5_score    0.628009
dtype: float64
valid_loss:  3.047500019921197
Learning rate after epoch 5: [3.825472731975857e-05]
top1_score    0.608210
top3_score    0.624813
top5_score    0.628009
dtype: float64

            best_value  on_step
top1_score    0.608210        4
top3_score    0.624813        4
top5_score    0.628009        4
Epoch 6/13: 100%|██████████| 4500/4500 [01:42<00:00, 44.09batch/s, loss=3.0625, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:19<00:00, 58.62batch/s]
top1_score    0.610707
top3_score    0.625182
top5_score    0.628127
dtype: float64
valid_loss:  3.0421734036339654
Learning rate after epoch 6: [3.825472731975857e-05]
top1_score    0.610707
top3_score    0.625182
top5_score    0.628127
dtype: float64

            best_value  on_step
top1_score    0.610707        5
top3_score    0.625182        5
top5_score    0.628127        5
Epoch 7/13: 100%|██████████| 4500/4500 [01:40<00:00, 44.75batch/s, loss=3.0092, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:18<00:00, 59.65batch/s]
top1_score    0.614558
top3_score    0.626992
top5_score    0.629153
dtype: float64
valid_loss:  3.0389412926567925
Learning rate after epoch 7: [3.825472731975857e-05]
top1_score    0.614558
top3_score    0.626992
top5_score    0.629153
dtype: float64

            best_value  on_step
top1_score    0.614558        6
top3_score    0.626992        6
top5_score    0.629153        6
Epoch 8/13: 100%|██████████| 4500/4500 [01:41<00:00, 44.27batch/s, loss=3.0303, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:18<00:00, 61.14batch/s]
top1_score    0.617134
top3_score    0.628378
top5_score    0.630144
dtype: float64
valid_loss:  3.037246739493476
Learning rate after epoch 8: [3.825472731975857e-05]
top1_score    0.617134
top3_score    0.628378
top5_score    0.630144
dtype: float64

            best_value  on_step
top1_score    0.617134        7
top3_score    0.628378        7
top5_score    0.630144        7
Epoch 9/13: 100%|██████████| 4500/4500 [01:41<00:00, 44.12batch/s, loss=3.0405, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:19<00:00, 58.47batch/s]
top1_score    0.612344
top3_score    0.624936
top5_score    0.628015
dtype: float64
valid_loss:  3.036572811126709
Learning rate after epoch 9: [3.825472731975857e-05]
top1_score    0.612344
top3_score    0.624936
top5_score    0.628015
dtype: float64

            best_value  on_step
top1_score    0.617134        7
top3_score    0.628378        7
top5_score    0.630144        7
Epoch 10/13: 100%|██████████| 4500/4500 [01:40<00:00, 44.68batch/s, loss=3.0486, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:18<00:00, 60.18batch/s]
top1_score    0.608788
top3_score    0.621574
top5_score    0.624832
dtype: float64
valid_loss:  3.0322803043789333
Learning rate after epoch 10: [3.825472731975857e-05]
top1_score    0.608788
top3_score    0.621574
top5_score    0.624832
dtype: float64

            best_value  on_step
top1_score    0.617134        7
top3_score    0.628378        7
top5_score    0.630144        7
Epoch 11/13: 100%|██████████| 4500/4500 [01:40<00:00, 44.57batch/s, loss=3.0403, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:19<00:00, 58.23batch/s]
top1_score    0.620713
top3_score    0.629815
top5_score    0.631348
dtype: float64
valid_loss:  3.0308507527245414
Learning rate after epoch 11: [3.825472731975857e-05]
top1_score    0.620713
top3_score    0.629815
top5_score    0.631348
dtype: float64

            best_value  on_step
top1_score    0.620713       10
top3_score    0.629815       10
top5_score    0.631348       10
Epoch 12/13: 100%|██████████| 4500/4500 [01:40<00:00, 44.83batch/s, loss=3.0525, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:18<00:00, 59.41batch/s]
top1_score    0.615651
top3_score    0.626084
top5_score    0.629402
dtype: float64
valid_loss:  3.0307682745191786
Learning rate after epoch 12: [3.825472731975857e-05]
top1_score    0.615651
top3_score    0.626084
top5_score    0.629402
dtype: float64

            best_value  on_step
top1_score    0.620713       10
top3_score    0.629815       10
top5_score    0.631348       10
Epoch 13/13: 100%|██████████| 4500/4500 [01:42<00:00, 43.99batch/s, loss=3.0511, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:18<00:00, 61.27batch/s]
top1_score    0.623068
top3_score    0.631174
top5_score    0.632597
dtype: float64
valid_loss:  3.0287572593688963
Learning rate after epoch 13: [3.825472731975857e-05]
top1_score    0.623068
top3_score    0.631174
top5_score    0.632597
dtype: float64

            best_value  on_step
top1_score    0.623068       12
top3_score    0.631174       12
top5_score    0.632597       12
Training finished!


------ start model testing ------
100%|██████████| 1125/1125 [00:18<00:00, 59.58batch/s]
Testing finished!
top1_score    0.621472
top3_score    0.629889
top5_score    0.631472
dtype: float64
Loss: 3.0301558842129177
Länge: 697932
---rebalance_test_from_train()---
100%|██████████| 36/36 [00:00<00:00, 1439.56it/s]
100%|██████████| 36/36 [00:00<00:00, 6337.40it/s]
Prepare Test-Dataset: 100%|██████████| 36/36 [00:00<00:00, 370.87label/s]
Klasse 0: Test 1000 - original Test 5778
Klasse 1: Test 1000 - original Test 6330
Klasse 2: Test 1000 - original Test 5869
Klasse 3: Test 1000 - original Test 5969
Klasse 4: Test 1000 - original Test 5619
Klasse 5: Test 1000 - original Test 5190
Klasse 6: Test 1000 - original Test 5705
Klasse 7: Test 1000 - original Test 6139
Klasse 8: Test 1000 - original Test 5633
Klasse 9: Test 1000 - original Test 5686
Klasse A: Test 1000 - original Test 1062
Klasse B: Test 648 - Train 352
Klasse C: Test 1000 - original Test 1739
Klasse D: Test 779 - Train 221
Klasse E: Test 851 - Train 149
Klasse F: Test 1000 - original Test 1440
Klasse G: Test 447 - Train 553
Klasse H: Test 521 - Train 479
Klasse I: Test 1000 - original Test 2048
Klasse J: Test 626 - Train 374
Klasse K: Test 382 - Train 618
Klasse L: Test 810 - Train 190
Klasse M: Test 1000 - original Test 1485
Klasse a: Test 1000 - original Test 1644
Klasse b: Test 853 - Train 147
Klasse c: Test 432 - Train 568
Klasse d: Test 1000 - original Test 1683
Klasse e: Test 1000 - original Test 4092
Klasse f: Test 400 - Train 600
Klasse g: Test 589 - Train 411
Klasse h: Test 1000 - original Test 1479
Klasse i: Test 427 - Train 573
Klasse j: Test 317 - Train 683
Klasse k: Test 466 - Train 534
Klasse l: Test 1000 - original Test 2535
Klasse m: Test 464 - Train 536
Länge danch: 507942
100%|██████████| 36/36 [00:00<00:00, 2263.86it/s]
Prepare Train-Dataset: 100%|██████████| 36/36 [00:00<00:00, 82.21label/s]
Label 0: Train 5000 orig 5000
Trainingsdaten nach Label 0: 5000
Label 1: Train 5000 orig 5000
Trainingsdaten nach Label 1: 10000
Label 2: Train 5000 orig 5000
Trainingsdaten nach Label 2: 15000
Label 3: Train 5000 orig 5000
Trainingsdaten nach Label 3: 20000
Label 4: Train 5000 orig 5000
Trainingsdaten nach Label 4: 25000
Label 5: Train 5000 orig 5000
Trainingsdaten nach Label 5: 30000
Label 6: Train 5000 orig 5000
Trainingsdaten nach Label 6: 35000
Label 7: Train 5000 orig 5000
Trainingsdaten nach Label 7: 40000
Label 8: Train 5000 orig 5000
Trainingsdaten nach Label 8: 45000
Label 9: Train 5000 orig 5000
Trainingsdaten nach Label 9: 50000
Label A: Train 5000 orig 5000
Trainingsdaten nach Label A: 55000
Label B: Train 3526 augmentated 1474
Trainingsdaten nach Label B: 60000
Label C: Train 5000 orig 5000
Trainingsdaten nach Label C: 65000
Label D: Train 4341 augmentated 659
Trainingsdaten nach Label D: 70000
Label E: Train 4785 augmentated 215
Trainingsdaten nach Label E: 75000
Label F: Train 5000 orig 5000
Trainingsdaten nach Label F: 80000
Label G: Train 1964 augmentated 3036
Trainingsdaten nach Label G: 85000
Label H: Train 2673 augmentated 2327
Trainingsdaten nach Label H: 90000
Label I: Train 5000 orig 5000
Trainingsdaten nach Label I: 95000
Label J: Train 3388 augmentated 1612
Trainingsdaten nach Label J: 100000
Label K: Train 1850 augmentated 3150
Trainingsdaten nach Label K: 105000
Label L: Train 4886 augmentated 114
Trainingsdaten nach Label L: 110000
Label M: Train 5000 orig 5000
Trainingsdaten nach Label M: 115000
Label a: Train 5000 orig 5000
Trainingsdaten nach Label a: 120000
Label b: Train 5000 orig 5000
Trainingsdaten nach Label b: 125000
Label c: Train 2286 augmentated 2714
Trainingsdaten nach Label c: 130000
Label d: Train 5000 orig 5000
Trainingsdaten nach Label d: 135000
Label e: Train 5000 orig 5000
Trainingsdaten nach Label e: 140000
Label f: Train 1961 augmentated 3039
Trainingsdaten nach Label f: 145000
Label g: Train 3276 augmentated 1724
Trainingsdaten nach Label g: 150000
Label h: Train 5000 orig 5000
Trainingsdaten nach Label h: 155000
Label i: Train 2152 augmentated 2848
Trainingsdaten nach Label i: 160000
Label j: Train 1213 augmentated 3787
Trainingsdaten nach Label j: 165000
Label k: Train 1957 augmentated 3043
Trainingsdaten nach Label k: 170000
Label l: Train 5000 orig 5000
Trainingsdaten nach Label l: 175000
Label m: Train 2109 augmentated 2891
Trainingsdaten nach Label m: 180000
{'lr': 3.825472731975857e-05,
'weight_decay': 0.000469,
'num_epochs': 25,
'batch_size': 32,
'only_train_classifier': False,
'sched_patience': 5,
'sched_factor': 0.442897,
'sched_min_lr': 1e-06,
'train_with_CombinedClassifier': True,
'probabilities': [1, 1, 1],
'config_CombinedClassifier': {'conv2d_out_1': 64, 'conv2d_kernel_size_1': 5,
'conv2d_out_2': 64, 'conv2d_kernel_size_2': 3, 'conv2d_out_3': 32,
'conv2d_kernel_size_3': 3, 'linear_out_1': 128,
'linear_out_2': 32, 'dropout': 0.32}}


-------------- Start New Training: ---------------


Epoch 1/25: 100%|██████████| 4500/4500 [01:41<00:00, 44.19batch/s, loss=3.3012, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:18<00:00, 61.44batch/s]
top1_score    0.335697
top3_score    0.353505
top5_score    0.360064
dtype: float64
valid_loss:  3.2780302306281195
Learning rate after epoch 1: [3.825472731975857e-05]
top1_score    0.335697
top3_score    0.353505
top5_score    0.360064
dtype: float64

            best_value  on_step
top1_score    0.335697        0
top3_score    0.353505        0
top5_score    0.360064        0
Epoch 2/25: 100%|██████████| 4500/4500 [01:41<00:00, 44.19batch/s, loss=3.2997, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:19<00:00, 57.80batch/s]
top1_score    0.341315
top3_score    0.358114
top5_score    0.363193
dtype: float64
valid_loss:  3.2732088777754043
Learning rate after epoch 2: [3.825472731975857e-05]
top1_score    0.341315
top3_score    0.358114
top5_score    0.363193
dtype: float64

            best_value  on_step
top1_score    0.341315        1
top3_score    0.358114        1
top5_score    0.363193        1
Epoch 3/25: 100%|██████████| 4500/4500 [01:40<00:00, 44.60batch/s, loss=3.2356, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:18<00:00, 59.48batch/s]
top1_score    0.341312
top3_score    0.355962
top5_score    0.361264
dtype: float64
valid_loss:  3.27308686765035
Learning rate after epoch 3: [3.825472731975857e-05]
top1_score    0.341312
top3_score    0.355962
top5_score    0.361264
dtype: float64

            best_value  on_step
top1_score    0.341315        1
top3_score    0.358114        1
top5_score    0.363193        1
Epoch 4/25: 100%|██████████| 4500/4500 [01:41<00:00, 44.22batch/s, loss=3.2844, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:19<00:00, 59.14batch/s]
top1_score    0.341835
top3_score    0.355016
top5_score    0.358207
dtype: float64
valid_loss:  3.2705434561835394
Learning rate after epoch 4: [3.825472731975857e-05]
top1_score    0.341835
top3_score    0.355016
top5_score    0.358207
dtype: float64

            best_value  on_step
top1_score    0.341835        3
top3_score    0.358114        1
top5_score    0.363193        1
Epoch 5/25: 100%|██████████| 4500/4500 [01:39<00:00, 45.04batch/s, loss=3.2865, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:19<00:00, 58.50batch/s]
top1_score    0.342551
top3_score    0.351115
top5_score    0.353292
dtype: float64
valid_loss:  3.2695157572428384
Learning rate after epoch 5: [3.825472731975857e-05]
top1_score    0.342551
top3_score    0.351115
top5_score    0.353292
dtype: float64

            best_value  on_step
top1_score    0.342551        4
top3_score    0.358114        1
top5_score    0.363193        1
Epoch 6/25: 100%|██████████| 4500/4500 [01:41<00:00, 44.17batch/s, loss=3.2586, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:18<00:00, 61.38batch/s]
top1_score    0.342526
top3_score    0.351981
top5_score    0.354297
dtype: float64
valid_loss:  3.268984000523885
Learning rate after epoch 6: [3.825472731975857e-05]
top1_score    0.342526
top3_score    0.351981
top5_score    0.354297
dtype: float64

            best_value  on_step
top1_score    0.342551        4
top3_score    0.358114        1
top5_score    0.363193        1
Epoch 7/25: 100%|██████████| 4500/4500 [01:41<00:00, 44.15batch/s, loss=3.2288, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:19<00:00, 57.96batch/s]
top1_score    0.346515
top3_score    0.357130
top5_score    0.361657
dtype: float64
valid_loss:  3.2686314470503066
Learning rate after epoch 7: [3.825472731975857e-05]
top1_score    0.346515
top3_score    0.357130
top5_score    0.361657
dtype: float64

            best_value  on_step
top1_score    0.346515        6
top3_score    0.358114        1
top5_score    0.363193        1
Epoch 8/25: 100%|██████████| 4500/4500 [01:41<00:00, 44.54batch/s, loss=3.2592, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:19<00:00, 57.43batch/s]
top1_score    0.344031
top3_score    0.356889
top5_score    0.362246
dtype: float64
valid_loss:  3.268727035522461
Learning rate after epoch 8: [3.825472731975857e-05]
top1_score    0.344031
top3_score    0.356889
top5_score    0.362246
dtype: float64

            best_value  on_step
top1_score    0.346515        6
top3_score    0.358114        1
top5_score    0.363193        1
Epoch 9/25: 100%|██████████| 4500/4500 [01:40<00:00, 44.62batch/s, loss=3.2729, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:20<00:00, 53.70batch/s]
top1_score    0.346101
top3_score    0.362534
top5_score    0.366939
dtype: float64
valid_loss:  3.268901151233249
Learning rate after epoch 9: [3.825472731975857e-05]
top1_score    0.346101
top3_score    0.362534
top5_score    0.366939
dtype: float64

            best_value  on_step
top1_score    0.346515        6
top3_score    0.362534        8
top5_score    0.366939        8
Epoch 10/25: 100%|██████████| 4500/4500 [01:40<00:00, 44.62batch/s, loss=3.2353, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:19<00:00, 58.30batch/s]
top1_score    0.361010
top3_score    0.378590
top5_score    0.385256
dtype: float64
valid_loss:  3.266753964530097
Learning rate after epoch 10: [3.825472731975857e-05]
top1_score    0.361010
top3_score    0.378590
top5_score    0.385256
dtype: float64

            best_value  on_step
top1_score    0.361010        9
top3_score    0.378590        9
top5_score    0.385256        9
Epoch 11/25: 100%|██████████| 4500/4500 [01:40<00:00, 44.69batch/s, loss=3.1847, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:20<00:00, 54.23batch/s]
top1_score    0.451224
top3_score    0.459563
top5_score    0.462100
dtype: float64
valid_loss:  3.176331739425659
Learning rate after epoch 11: [3.825472731975857e-05]
top1_score    0.451224
top3_score    0.459563
top5_score    0.462100
dtype: float64

            best_value  on_step
top1_score    0.451224       10
top3_score    0.459563       10
top5_score    0.462100       10
Epoch 12/25: 100%|██████████| 4500/4500 [01:40<00:00, 44.64batch/s, loss=3.1249, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:20<00:00, 54.11batch/s]
top1_score    0.476648
top3_score    0.486506
top5_score    0.488536
dtype: float64
valid_loss:  3.155509073469374
Learning rate after epoch 12: [3.825472731975857e-05]
top1_score    0.476648
top3_score    0.486506
top5_score    0.488536
dtype: float64

            best_value  on_step
top1_score    0.476648       11
top3_score    0.486506       11
top5_score    0.488536       11
Epoch 13/25: 100%|██████████| 4500/4500 [01:40<00:00, 44.71batch/s, loss=3.1159, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:19<00:00, 57.85batch/s]
top1_score    0.497768
top3_score    0.512714
top5_score    0.517942
dtype: float64
valid_loss:  3.133806975894504
Learning rate after epoch 13: [3.825472731975857e-05]
top1_score    0.497768
top3_score    0.512714
top5_score    0.517942
dtype: float64

            best_value  on_step
top1_score    0.497768       12
top3_score    0.512714       12
top5_score    0.517942       12
Epoch 14/25: 100%|██████████| 4500/4500 [01:40<00:00, 44.62batch/s, loss=3.1265, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:20<00:00, 54.12batch/s]
top1_score    0.498335
top3_score    0.520903
top5_score    0.526452
dtype: float64
valid_loss:  3.1293707281748455
Learning rate after epoch 14: [3.825472731975857e-05]
top1_score    0.498335
top3_score    0.520903
top5_score    0.526452
dtype: float64

            best_value  on_step
top1_score    0.498335       13
top3_score    0.520903       13
top5_score    0.526452       13
Epoch 15/25: 100%|██████████| 4500/4500 [01:40<00:00, 44.62batch/s, loss=3.1235, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:19<00:00, 58.59batch/s]
top1_score    0.532238
top3_score    0.547246
top5_score    0.550979
dtype: float64
valid_loss:  3.0960912431081136
Learning rate after epoch 15: [3.825472731975857e-05]
top1_score    0.532238
top3_score    0.547246
top5_score    0.550979
dtype: float64

            best_value  on_step
top1_score    0.532238       14
top3_score    0.547246       14
top5_score    0.550979       14
Epoch 16/25: 100%|██████████| 4500/4500 [01:40<00:00, 44.61batch/s, loss=3.0858, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:20<00:00, 54.12batch/s]
top1_score    0.536654
top3_score    0.549598
top5_score    0.553214
dtype: float64
valid_loss:  3.095517457962036
Learning rate after epoch 16: [3.825472731975857e-05]
top1_score    0.536654
top3_score    0.549598
top5_score    0.553214
dtype: float64

            best_value  on_step
top1_score    0.536654       15
top3_score    0.549598       15
top5_score    0.553214       15
Epoch 17/25: 100%|██████████| 4500/4500 [01:40<00:00, 44.65batch/s, loss=3.0832, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:20<00:00, 53.97batch/s]
top1_score    0.539686
top3_score    0.554232
top5_score    0.557372
dtype: float64
valid_loss:  3.0863758748372394
Learning rate after epoch 17: [3.825472731975857e-05]
top1_score    0.539686
top3_score    0.554232
top5_score    0.557372
dtype: float64

            best_value  on_step
top1_score    0.539686       16
top3_score    0.554232       16
top5_score    0.557372       16
Epoch 18/25: 100%|██████████| 4500/4500 [01:40<00:00, 44.81batch/s, loss=3.0398, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:19<00:00, 56.94batch/s]
top1_score    0.538632
top3_score    0.555599
top5_score    0.561577
dtype: float64
valid_loss:  3.0871511611938476
Learning rate after epoch 18: [3.825472731975857e-05]
top1_score    0.538632
top3_score    0.555599
top5_score    0.561577
dtype: float64

            best_value  on_step
top1_score    0.539686       16
top3_score    0.555599       17
top5_score    0.561577       17
Epoch 19/25: 100%|██████████| 4500/4500 [01:40<00:00, 44.62batch/s, loss=3.0627, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:20<00:00, 54.10batch/s]
top1_score    0.540192
top3_score    0.555684
top5_score    0.559432
dtype: float64
valid_loss:  3.083893682479858
Learning rate after epoch 19: [3.825472731975857e-05]
top1_score    0.540192
top3_score    0.555684
top5_score    0.559432
dtype: float64

            best_value  on_step
top1_score    0.540192       18
top3_score    0.555684       18
top5_score    0.561577       17
Epoch 20/25: 100%|██████████| 4500/4500 [01:40<00:00, 44.64batch/s, loss=3.1123, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:18<00:00, 59.26batch/s]
top1_score    0.542107
top3_score    0.556999
top5_score    0.561923
dtype: float64
valid_loss:  3.0837661569383408
Learning rate after epoch 20: [3.825472731975857e-05]
top1_score    0.542107
top3_score    0.556999
top5_score    0.561923
dtype: float64

            best_value  on_step
top1_score    0.542107       19
top3_score    0.556999       19
top5_score    0.561923       19
Epoch 21/25: 100%|██████████| 4500/4500 [01:41<00:00, 44.21batch/s, loss=3.0146, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:18<00:00, 59.52batch/s]
top1_score    0.540465
top3_score    0.553740
top5_score    0.558171
dtype: float64
valid_loss:  3.083767711639404
Learning rate after epoch 21: [3.825472731975857e-05]
top1_score    0.540465
top3_score    0.553740
top5_score    0.558171
dtype: float64

            best_value  on_step
top1_score    0.542107       19
top3_score    0.556999       19
top5_score    0.561923       19
Epoch 22/25: 100%|██████████| 4500/4500 [01:41<00:00, 44.50batch/s, loss=3.0630, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:18<00:00, 59.84batch/s]
top1_score    0.539156
top3_score    0.553863
top5_score    0.558314
dtype: float64
valid_loss:  3.087871699439155
Learning rate after epoch 22: [3.825472731975857e-05]
top1_score    0.539156
top3_score    0.553863
top5_score    0.558314
dtype: float64

            best_value  on_step
top1_score    0.542107       19
top3_score    0.556999       19
top5_score    0.561923       19
Epoch 23/25: 100%|██████████| 4500/4500 [01:42<00:00, 43.77batch/s, loss=3.0707, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:18<00:00, 61.11batch/s]
top1_score    0.542390
top3_score    0.558292
top5_score    0.563732
dtype: float64
valid_loss:  3.083337644153171
Learning rate after epoch 23: [3.825472731975857e-05]
top1_score    0.542390
top3_score    0.558292
top5_score    0.563732
dtype: float64

            best_value  on_step
top1_score    0.542390       22
top3_score    0.558292       22
top5_score    0.563732       22
Epoch 24/25: 100%|██████████| 4500/4500 [01:42<00:00, 43.98batch/s, loss=3.0489, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:18<00:00, 60.20batch/s]
top1_score    0.564848
top3_score    0.580351
top5_score    0.584178
dtype: float64
valid_loss:  3.0643521677652994
Learning rate after epoch 24: [3.825472731975857e-05]
top1_score    0.564848
top3_score    0.580351
top5_score    0.584178
dtype: float64

            best_value  on_step
top1_score    0.564848       23
top3_score    0.580351       23
top5_score    0.584178       23
Epoch 25/25: 100%|██████████| 4500/4500 [01:42<00:00, 44.01batch/s, loss=3.1217, lr=0.000038]

Model validation...
100%|██████████| 1125/1125 [00:18<00:00, 61.46batch/s]
top1_score    0.566776
top3_score    0.579139
top5_score    0.581987
dtype: float64
valid_loss:  3.0606783044603136
Learning rate after epoch 25: [3.825472731975857e-05]
top1_score    0.566776
top3_score    0.579139
top5_score    0.581987
dtype: float64

            best_value  on_step
top1_score    0.566776       24
top3_score    0.580351       23
top5_score    0.584178       23
Training finished!


------ start model testing ------
100%|██████████| 1125/1125 [00:17<00:00, 62.53batch/s]
Testing finished!
top1_score    0.560194
top3_score    0.575056
top5_score    0.579000
dtype: float64
Loss: 3.06969234085083