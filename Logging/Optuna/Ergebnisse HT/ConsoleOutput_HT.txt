cat nohup.out
2025-06-23 23:46:35.318487: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1750715195.334687  844030 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1750715195.339599  844030 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-06-23 23:46:35.356655: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
mean: [0.485, 0.456, 0.406], std: [0.229, 0.224, 0.225]
Länge: 697932
---rebalance_test_from_train()---
100%|██████████| 36/36 [00:00<00:00, 1543.84it/s]
100%|██████████| 36/36 [00:00<00:00, 6886.57it/s]
Prepare Test-Dataset: 100%|██████████| 36/36 [00:00<00:00, 381.54label/s]
Klasse 0: Test 1000 - original Test 5778
Klasse 1: Test 1000 - original Test 6330
Klasse 2: Test 1000 - original Test 5869
Klasse 3: Test 1000 - original Test 5969
Klasse 4: Test 1000 - original Test 5619
Klasse 5: Test 1000 - original Test 5190
Klasse 6: Test 1000 - original Test 5705
Klasse 7: Test 1000 - original Test 6139
Klasse 8: Test 1000 - original Test 5633
Klasse 9: Test 1000 - original Test 5686
Klasse A: Test 1000 - original Test 1062
Klasse B: Test 648 - Train 352
Klasse C: Test 1000 - original Test 1739
Klasse D: Test 779 - Train 221
Klasse E: Test 851 - Train 149
Klasse F: Test 1000 - original Test 1440
Klasse G: Test 447 - Train 553
Klasse H: Test 521 - Train 479
Klasse I: Test 1000 - original Test 2048
Klasse J: Test 626 - Train 374
Klasse K: Test 382 - Train 618
Klasse L: Test 810 - Train 190
Klasse M: Test 1000 - original Test 1485
Klasse a: Test 1000 - original Test 1644
Klasse b: Test 853 - Train 147
Klasse c: Test 432 - Train 568
Klasse d: Test 1000 - original Test 1683
Klasse e: Test 1000 - original Test 4092
Klasse f: Test 400 - Train 600
Klasse g: Test 589 - Train 411
Klasse h: Test 1000 - original Test 1479
Klasse i: Test 427 - Train 573
Klasse j: Test 317 - Train 683
Klasse k: Test 466 - Train 534
Klasse l: Test 1000 - original Test 2535
Klasse m: Test 464 - Train 536
Länge danch: 507942
100%|██████████| 36/36 [00:00<00:00, 2290.68it/s]
Prepare Train-Dataset: 100%|██████████| 36/36 [00:00<00:00, 87.11label/s]
[I 2025-06-23 23:46:38,359] A new study created in RDB with name: HyperparameterTuning_2306_2
Downloading: "https://download.pytorch.org/models/resnet18-f37072fd.pth" to /home/c611/.cache/torch/hub/checkpoints/resnet18-f37072fd.pth
Label 0: Train 5000 orig 5000
Trainingsdaten nach Label 0: 5000
Label 1: Train 5000 orig 5000
Trainingsdaten nach Label 1: 10000
Label 2: Train 5000 orig 5000
Trainingsdaten nach Label 2: 15000
Label 3: Train 5000 orig 5000
Trainingsdaten nach Label 3: 20000
Label 4: Train 5000 orig 5000
Trainingsdaten nach Label 4: 25000
Label 5: Train 5000 orig 5000
Trainingsdaten nach Label 5: 30000
Label 6: Train 5000 orig 5000
Trainingsdaten nach Label 6: 35000
Label 7: Train 5000 orig 5000
Trainingsdaten nach Label 7: 40000
Label 8: Train 5000 orig 5000
Trainingsdaten nach Label 8: 45000
Label 9: Train 5000 orig 5000
Trainingsdaten nach Label 9: 50000
Label A: Train 5000 orig 5000
Trainingsdaten nach Label A: 55000
Label B: Train 3526 augmentated 1474
Trainingsdaten nach Label B: 60000
Label C: Train 5000 orig 5000
Trainingsdaten nach Label C: 65000
Label D: Train 4341 augmentated 659
Trainingsdaten nach Label D: 70000
Label E: Train 4785 augmentated 215
Trainingsdaten nach Label E: 75000
Label F: Train 5000 orig 5000
Trainingsdaten nach Label F: 80000
Label G: Train 1964 augmentated 3036
Trainingsdaten nach Label G: 85000
Label H: Train 2673 augmentated 2327
Trainingsdaten nach Label H: 90000
Label I: Train 5000 orig 5000
Trainingsdaten nach Label I: 95000
Label J: Train 3388 augmentated 1612
Trainingsdaten nach Label J: 100000
Label K: Train 1850 augmentated 3150
Trainingsdaten nach Label K: 105000
Label L: Train 4886 augmentated 114
Trainingsdaten nach Label L: 110000
Label M: Train 5000 orig 5000
Trainingsdaten nach Label M: 115000
Label a: Train 5000 orig 5000
Trainingsdaten nach Label a: 120000
Label b: Train 5000 orig 5000
Trainingsdaten nach Label b: 125000
Label c: Train 2286 augmentated 2714
Trainingsdaten nach Label c: 130000
Label d: Train 5000 orig 5000
Trainingsdaten nach Label d: 135000
Label e: Train 5000 orig 5000
Trainingsdaten nach Label e: 140000
Label f: Train 1961 augmentated 3039
Trainingsdaten nach Label f: 145000
Label g: Train 3276 augmentated 1724
Trainingsdaten nach Label g: 150000
Label h: Train 5000 orig 5000
Trainingsdaten nach Label h: 155000
Label i: Train 2152 augmentated 2848
Trainingsdaten nach Label i: 160000
Label j: Train 1213 augmentated 3787
Trainingsdaten nach Label j: 165000
Label k: Train 1957 augmentated 3043
Trainingsdaten nach Label k: 170000
Label l: Train 5000 orig 5000
Trainingsdaten nach Label l: 175000
Label m: Train 2109 augmentated 2891
Trainingsdaten nach Label m: 180000
{'lr': 1.3143593276649856e-05, 'weight_decay': 0.0020335235477712808, 'num_epochs': 15, 'batch_size': 16, 'only_train_classifier': True, 'sched_patience': 7, 'sched_factor': 0.8956638956399972, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


100%|██████████| 44.7M/44.7M [00:00<00:00, 89.0MB/s]
Epoch 1/15: 100%|██████████| 9000/9000 [01:11<00:00, 126.13batch/s]

Model validation...
100%|██████████| 2250/2250 [00:15<00:00, 149.56batch/s]
top1_score    0.369738
top3_score    0.639335
top5_score    0.750555
dtype: float64
valid_loss:  2.3475000783072577
Learning rate after epoch 1: [1.3143593276649856e-05]
Epoch 2/15: 100%|██████████| 9000/9000 [01:11<00:00, 125.92batch/s]

Model validation...
100%|██████████| 2250/2250 [00:15<00:00, 147.55batch/s]
top1_score    0.480326
top3_score    0.748830
top5_score    0.841296
dtype: float64
valid_loss:  1.8954389652940962
Learning rate after epoch 2: [1.3143593276649856e-05]
Epoch 3/15: 100%|██████████| 9000/9000 [01:12<00:00, 123.55batch/s]

Model validation...
100%|██████████| 2250/2250 [00:15<00:00, 144.05batch/s]
top1_score    0.527979
top3_score    0.795472
top5_score    0.875554
dtype: float64
valid_loss:  1.6502373173766667
Learning rate after epoch 3: [1.3143593276649856e-05]
Epoch 4/15: 100%|██████████| 9000/9000 [01:10<00:00, 128.00batch/s]

Model validation...
100%|██████████| 2250/2250 [00:14<00:00, 151.02batch/s]
top1_score    0.554045
top3_score    0.817021
top5_score    0.891351
dtype: float64
valid_loss:  1.5356970933278402
Learning rate after epoch 4: [1.3143593276649856e-05]
Epoch 5/15: 100%|██████████| 9000/9000 [01:12<00:00, 123.87batch/s]

Model validation...
100%|██████████| 2250/2250 [00:14<00:00, 150.66batch/s]
top1_score    0.574089
top3_score    0.835119
top5_score    0.903485
dtype: float64
valid_loss:  1.4311059679720137
Learning rate after epoch 5: [1.3143593276649856e-05]
Epoch 6/15: 100%|██████████| 9000/9000 [01:10<00:00, 127.73batch/s]

Model validation...
100%|██████████| 2250/2250 [00:14<00:00, 150.33batch/s]
top1_score    0.585797
top3_score    0.842680
top5_score    0.909082
dtype: float64
valid_loss:  1.3851559777259828
Learning rate after epoch 6: [1.3143593276649856e-05]
Epoch 7/15: 100%|██████████| 9000/9000 [01:11<00:00, 125.54batch/s]

Model validation...
100%|██████████| 2250/2250 [00:15<00:00, 149.04batch/s]
top1_score    0.602629
top3_score    0.853487
top5_score    0.915412
dtype: float64
valid_loss:  1.3230204518106248
Learning rate after epoch 7: [1.3143593276649856e-05]
Epoch 8/15: 100%|██████████| 9000/9000 [01:11<00:00, 125.53batch/s]

Model validation...
100%|██████████| 2250/2250 [00:15<00:00, 148.44batch/s]
top1_score    0.608522
top3_score    0.858107
top5_score    0.920772
dtype: float64
valid_loss:  1.2876955168512132
Learning rate after epoch 8: [1.3143593276649856e-05]
Epoch 9/15: 100%|██████████| 9000/9000 [01:15<00:00, 118.95batch/s]

Model validation...
100%|██████████| 2250/2250 [00:15<00:00, 149.50batch/s]
top1_score    0.620007
top3_score    0.864321
top5_score    0.922822
dtype: float64
valid_loss:  1.2516800240675607
Learning rate after epoch 9: [1.3143593276649856e-05]
Epoch 10/15: 100%|██████████| 9000/9000 [01:14<00:00, 121.26batch/s]

Model validation...
100%|██████████| 2250/2250 [00:15<00:00, 149.61batch/s]
top1_score    0.624739
top3_score    0.866235
top5_score    0.926691
dtype: float64
valid_loss:  1.2273455126020643
Learning rate after epoch 10: [1.3143593276649856e-05]
Epoch 11/15: 100%|██████████| 9000/9000 [01:13<00:00, 122.77batch/s]

Model validation...
100%|██████████| 2250/2250 [00:15<00:00, 147.52batch/s]
top1_score    0.628351
top3_score    0.870247
top5_score    0.928385
dtype: float64
valid_loss:  1.2136435940795474
Learning rate after epoch 11: [1.3143593276649856e-05]
Epoch 12/15: 100%|██████████| 9000/9000 [01:13<00:00, 123.15batch/s]

Model validation...
100%|██████████| 2250/2250 [00:15<00:00, 149.52batch/s]
top1_score    0.626322
top3_score    0.870542
top5_score    0.929041
dtype: float64
valid_loss:  1.2114500079684787
Learning rate after epoch 12: [1.3143593276649856e-05]
Epoch 13/15: 100%|██████████| 9000/9000 [01:12<00:00, 123.80batch/s]

Model validation...
100%|██████████| 2250/2250 [00:15<00:00, 147.10batch/s]
top1_score    0.638156
top3_score    0.876771
top5_score    0.931242
dtype: float64
valid_loss:  1.1774409726725685
Learning rate after epoch 13: [1.3143593276649856e-05]
Epoch 14/15: 100%|██████████| 9000/9000 [01:12<00:00, 124.39batch/s]

Model validation...
100%|██████████| 2250/2250 [00:14<00:00, 150.16batch/s]
top1_score    0.643003
top3_score    0.879117
top5_score    0.933661
dtype: float64
valid_loss:  1.1626923520697487
Learning rate after epoch 14: [1.3143593276649856e-05]
Epoch 15/15: 100%|██████████| 9000/9000 [01:12<00:00, 124.54batch/s]

Model validation...
100%|██████████| 2250/2250 [00:15<00:00, 149.88batch/s]
[I 2025-06-24 00:08:32,584] Trial 0 finished with value: 0.6495883464813232 and parameters: {'lr': 1.3143593276649856e-05, 'weight_decay': 0.0020335235477712808, 'num_epochs': 15, 'batch_size': 16, 'only_train_classifier': True, 'sched_patience': 7, 'sched_factor': 0.8956638956399972, 'sched_min_lr': 1e-06}. Best is trial 0 with value: 0.6495883464813232.
top1_score    0.649588
top3_score    0.882174
top5_score    0.936162
dtype: float64
valid_loss:  1.134531671471066
Learning rate after epoch 15: [1.3143593276649856e-05]
Training finished!
{'lr': 1.603651096212887e-05, 'weight_decay': 0.00018683250391820003, 'num_epochs': 17, 'batch_size': 32, 'only_train_classifier': False, 'sched_patience': 13, 'sched_factor': 0.6678004521007488, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/17: 100%|██████████| 4500/4500 [00:56<00:00, 80.29batch/s]

Model validation...
100%|██████████| 1125/1125 [00:11<00:00, 100.59batch/s]
top1_score    0.840502
top3_score    0.984236
top5_score    0.994936
dtype: float64
valid_loss:  0.398439132783148
Learning rate after epoch 1: [1.603651096212887e-05]
Epoch 2/17: 100%|██████████| 4500/4500 [00:54<00:00, 82.43batch/s]

Model validation...
100%|██████████| 1125/1125 [00:11<00:00, 102.09batch/s]
top1_score    0.860172
top3_score    0.987972
top5_score    0.997069
dtype: float64
valid_loss:  0.34862078829606374
Learning rate after epoch 2: [1.603651096212887e-05]
Epoch 3/17: 100%|██████████| 4500/4500 [00:55<00:00, 81.15batch/s]

Model validation...
100%|██████████| 1125/1125 [00:11<00:00, 100.42batch/s]
top1_score    0.861479
top3_score    0.989834
top5_score    0.997897
dtype: float64
valid_loss:  0.3364467758403884
Learning rate after epoch 3: [1.603651096212887e-05]
Epoch 4/17: 100%|██████████| 4500/4500 [00:56<00:00, 80.32batch/s]

Model validation...
100%|██████████| 1125/1125 [00:11<00:00, 100.19batch/s]
top1_score    0.862014
top3_score    0.989895
top5_score    0.998115
dtype: float64
valid_loss:  0.3315979449748993
Learning rate after epoch 4: [1.603651096212887e-05]
Epoch 5/17: 100%|██████████| 4500/4500 [00:57<00:00, 77.68batch/s]

Model validation...
100%|██████████| 1125/1125 [00:11<00:00, 102.23batch/s]
top1_score    0.871647
top3_score    0.991567
top5_score    0.998448
dtype: float64
valid_loss:  0.31296545676059195
Learning rate after epoch 5: [1.603651096212887e-05]
Epoch 6/17: 100%|██████████| 4500/4500 [00:56<00:00, 80.14batch/s]

Model validation...
100%|██████████| 1125/1125 [00:11<00:00, 101.29batch/s]
top1_score    0.875985
top3_score    0.991837
top5_score    0.998672
dtype: float64
valid_loss:  0.3117350375552972
Learning rate after epoch 6: [1.603651096212887e-05]
Epoch 7/17: 100%|██████████| 4500/4500 [00:54<00:00, 82.13batch/s]

Model validation...
100%|██████████| 1125/1125 [00:10<00:00, 102.57batch/s]
top1_score    0.875562
top3_score    0.991172
top5_score    0.998451
dtype: float64
valid_loss:  0.31351309963067375
Learning rate after epoch 7: [1.603651096212887e-05]
Epoch 8/17: 100%|██████████| 4500/4500 [00:54<00:00, 82.29batch/s]

Model validation...
100%|██████████| 1125/1125 [00:11<00:00, 98.26batch/s]
top1_score    0.878757
top3_score    0.991482
top5_score    0.998154
dtype: float64
valid_loss:  0.3134951364116536
Learning rate after epoch 8: [1.603651096212887e-05]
Epoch 9/17: 100%|██████████| 4500/4500 [00:55<00:00, 80.91batch/s]

Model validation...
100%|██████████| 1125/1125 [00:11<00:00, 101.02batch/s]
top1_score    0.880624
top3_score    0.992144
top5_score    0.998121
dtype: float64
valid_loss:  0.31461535924176376
Learning rate after epoch 9: [1.603651096212887e-05]
Epoch 10/17: 100%|██████████| 4500/4500 [00:54<00:00, 82.05batch/s]

Model validation...
100%|██████████| 1125/1125 [00:11<00:00, 101.20batch/s]
top1_score    0.881576
top3_score    0.991891
top5_score    0.998071
dtype: float64
valid_loss:  0.32364037675658863
Learning rate after epoch 10: [1.603651096212887e-05]
Epoch 11/17: 100%|██████████| 4500/4500 [00:54<00:00, 83.02batch/s]

Model validation...
100%|██████████| 1125/1125 [00:11<00:00, 100.82batch/s]
top1_score    0.884386
top3_score    0.991929
top5_score    0.997988
dtype: float64
valid_loss:  0.3232868720508284
Learning rate after epoch 11: [1.603651096212887e-05]
Epoch 12/17: 100%|██████████| 4500/4500 [00:57<00:00, 78.14batch/s]

Model validation...
100%|██████████| 1125/1125 [00:11<00:00, 101.58batch/s]
top1_score    0.882076
top3_score    0.991865
top5_score    0.997805
dtype: float64
valid_loss:  0.3379856162650718
Learning rate after epoch 12: [1.603651096212887e-05]
Epoch 13/17: 100%|██████████| 4500/4500 [00:56<00:00, 79.83batch/s]

Model validation...
100%|██████████| 1125/1125 [00:11<00:00, 100.78batch/s]
top1_score    0.887058
top3_score    0.991478
top5_score    0.997630
dtype: float64
valid_loss:  0.33227462638749017
Learning rate after epoch 13: [1.603651096212887e-05]
Epoch 14/17: 100%|██████████| 4500/4500 [00:54<00:00, 82.33batch/s]

Model validation...
100%|██████████| 1125/1125 [00:11<00:00, 99.18batch/s]
top1_score    0.888837
top3_score    0.991846
top5_score    0.997380
dtype: float64
valid_loss:  0.335040063575738
Learning rate after epoch 14: [1.603651096212887e-05]
Epoch 15/17: 100%|██████████| 4500/4500 [00:56<00:00, 79.05batch/s]

Model validation...
100%|██████████| 1125/1125 [00:11<00:00, 101.45batch/s]
top1_score    0.882206
top3_score    0.991011
top5_score    0.997660
dtype: float64
valid_loss:  0.35148359385050004
Learning rate after epoch 15: [1.603651096212887e-05]
Epoch 16/17: 100%|██████████| 4500/4500 [00:55<00:00, 81.39batch/s]

Model validation...
100%|██████████| 1125/1125 [00:11<00:00, 98.04batch/s]
top1_score    0.886935
top3_score    0.991114
top5_score    0.997383
dtype: float64
valid_loss:  0.3605973207544949
Learning rate after epoch 16: [1.603651096212887e-05]
Epoch 17/17: 100%|██████████| 4500/4500 [00:55<00:00, 80.41batch/s]

Model validation...
100%|██████████| 1125/1125 [00:11<00:00, 100.21batch/s]
[I 2025-06-24 00:27:30,344] Trial 1 finished with value: 0.8901015520095825 and parameters: {'lr': 1.603651096212887e-05, 'weight_decay': 0.00018683250391820003, 'num_epochs': 17, 'batch_size': 32, 'only_train_classifier': False, 'sched_patience': 13, 'sched_factor': 0.6678004521007488, 'sched_min_lr': 1e-06}. Best is trial 1 with value: 0.8901015520095825.
top1_score    0.890102
top3_score    0.991144
top5_score    0.997275
dtype: float64
valid_loss:  0.357274769856698
Learning rate after epoch 17: [1.603651096212887e-05]
Training finished!
{'lr': 0.001424073892735471, 'weight_decay': 0.000556607727018623, 'num_epochs': 28, 'batch_size': 64, 'only_train_classifier': True, 'sched_patience': 13, 'sched_factor': 0.6709354569227064, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/28: 100%|██████████| 2250/2250 [00:40<00:00, 55.10batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.45batch/s]
top1_score    0.673913
top3_score    0.906234
top5_score    0.951746
dtype: float64
valid_loss:  1.0072779522060713
Learning rate after epoch 1: [0.001424073892735471]
Epoch 2/28: 100%|██████████| 2250/2250 [00:39<00:00, 56.29batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 56.89batch/s]
top1_score    0.692524
top3_score    0.921500
top5_score    0.962147
dtype: float64
valid_loss:  0.9352638592834371
Learning rate after epoch 2: [0.001424073892735471]
Epoch 3/28: 100%|██████████| 2250/2250 [00:40<00:00, 55.67batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 58.10batch/s]
top1_score    0.705906
top3_score    0.927579
top5_score    0.965130
dtype: float64
valid_loss:  0.8952932906193166
Learning rate after epoch 3: [0.001424073892735471]
Epoch 4/28: 100%|██████████| 2250/2250 [00:40<00:00, 55.69batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.74batch/s]
top1_score    0.710341
top3_score    0.930474
top5_score    0.967737
dtype: float64
valid_loss:  0.8719336970131943
Learning rate after epoch 4: [0.001424073892735471]
Epoch 5/28: 100%|██████████| 2250/2250 [00:40<00:00, 55.16batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.67batch/s]
top1_score    0.709969
top3_score    0.930625
top5_score    0.966849
dtype: float64
valid_loss:  0.8756968454188182
Learning rate after epoch 5: [0.001424073892735471]
Epoch 6/28: 100%|██████████| 2250/2250 [00:40<00:00, 55.69batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.79batch/s]
top1_score    0.716298
top3_score    0.935733
top5_score    0.970147
dtype: float64
valid_loss:  0.8378997038566833
Learning rate after epoch 6: [0.001424073892735471]
Epoch 7/28: 100%|██████████| 2250/2250 [00:41<00:00, 54.28batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.85batch/s]
top1_score    0.716110
top3_score    0.936436
top5_score    0.970373
dtype: float64
valid_loss:  0.8558121297118083
Learning rate after epoch 7: [0.001424073892735471]
Epoch 8/28: 100%|██████████| 2250/2250 [00:40<00:00, 55.39batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 55.41batch/s]
top1_score    0.724718
top3_score    0.937249
top5_score    0.970781
dtype: float64
valid_loss:  0.8276291178344198
Learning rate after epoch 8: [0.001424073892735471]
Epoch 9/28: 100%|██████████| 2250/2250 [00:41<00:00, 53.65batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 58.26batch/s]
top1_score    0.728560
top3_score    0.939966
top5_score    0.971747
dtype: float64
valid_loss:  0.8206637941605245
Learning rate after epoch 9: [0.001424073892735471]
Epoch 10/28: 100%|██████████| 2250/2250 [00:39<00:00, 56.51batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.82batch/s]
top1_score    0.725488
top3_score    0.941850
top5_score    0.973297
dtype: float64
valid_loss:  0.8124002895812582
Learning rate after epoch 10: [0.001424073892735471]
Epoch 11/28: 100%|██████████| 2250/2250 [00:41<00:00, 54.15batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 54.13batch/s]
top1_score    0.722863
top3_score    0.939260
top5_score    0.971319
dtype: float64
valid_loss:  0.8276659712910017
Learning rate after epoch 11: [0.001424073892735471]
Epoch 12/28: 100%|██████████| 2250/2250 [00:40<00:00, 54.97batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 55.93batch/s]
top1_score    0.725166
top3_score    0.938599
top5_score    0.971818
dtype: float64
valid_loss:  0.8289201235263005
Learning rate after epoch 12: [0.001424073892735471]
Epoch 13/28: 100%|██████████| 2250/2250 [00:40<00:00, 55.50batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 58.25batch/s]
top1_score    0.723904
top3_score    0.937191
top5_score    0.969997
dtype: float64
valid_loss:  0.8510338620648291
Learning rate after epoch 13: [0.001424073892735471]
Epoch 14/28: 100%|██████████| 2250/2250 [00:40<00:00, 56.08batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.39batch/s]
top1_score    0.730609
top3_score    0.940878
top5_score    0.972690
dtype: float64
valid_loss:  0.8117811633786766
Learning rate after epoch 14: [0.001424073892735471]
Epoch 15/28: 100%|██████████| 2250/2250 [00:40<00:00, 55.46batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 55.01batch/s]
top1_score    0.727894
top3_score    0.938735
top5_score    0.971722
dtype: float64
valid_loss:  0.8262069369823428
Learning rate after epoch 15: [0.001424073892735471]
Epoch 16/28: 100%|██████████| 2250/2250 [00:40<00:00, 54.89batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.16batch/s]
top1_score    0.734145
top3_score    0.943175
top5_score    0.974572
dtype: float64
valid_loss:  0.8027819012875667
Learning rate after epoch 16: [0.001424073892735471]
Epoch 17/28: 100%|██████████| 2250/2250 [00:40<00:00, 55.03batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 58.73batch/s]
top1_score    0.724586
top3_score    0.938236
top5_score    0.971513
dtype: float64
valid_loss:  0.8400983882416205
Learning rate after epoch 17: [0.001424073892735471]
Epoch 18/28: 100%|██████████| 2250/2250 [00:39<00:00, 56.93batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 58.55batch/s]
top1_score    0.726375
top3_score    0.939072
top5_score    0.971693
dtype: float64
valid_loss:  0.8348428055935178
Learning rate after epoch 18: [0.001424073892735471]
Epoch 19/28: 100%|██████████| 2250/2250 [00:40<00:00, 55.81batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 56.88batch/s]
top1_score    0.725304
top3_score    0.939937
top5_score    0.973563
dtype: float64
valid_loss:  0.8247744839631854
Learning rate after epoch 19: [0.001424073892735471]
Epoch 20/28: 100%|██████████| 2250/2250 [00:40<00:00, 55.86batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 58.78batch/s]
top1_score    0.733809
top3_score    0.943194
top5_score    0.975011
dtype: float64
valid_loss:  0.7920154157370911
Learning rate after epoch 20: [0.001424073892735471]
Epoch 21/28: 100%|██████████| 2250/2250 [00:41<00:00, 54.72batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.32batch/s]
top1_score    0.732415
top3_score    0.942418
top5_score    0.973999
dtype: float64
valid_loss:  0.8010573150527202
Learning rate after epoch 21: [0.001424073892735471]
Epoch 22/28: 100%|██████████| 2250/2250 [00:40<00:00, 55.96batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.95batch/s]
top1_score    0.734058
top3_score    0.942627
top5_score    0.973605
dtype: float64
valid_loss:  0.796643911998183
Learning rate after epoch 22: [0.001424073892735471]
Epoch 23/28: 100%|██████████| 2250/2250 [00:40<00:00, 55.38batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.33batch/s]
top1_score    0.732223
top3_score    0.941627
top5_score    0.972740
dtype: float64
valid_loss:  0.8085415008118902
Learning rate after epoch 23: [0.001424073892735471]
Epoch 24/28: 100%|██████████| 2250/2250 [00:40<00:00, 56.22batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.40batch/s]
top1_score    0.725074
top3_score    0.938230
top5_score    0.970911
dtype: float64
valid_loss:  0.8229637894494919
Learning rate after epoch 24: [0.001424073892735471]
Epoch 25/28: 100%|██████████| 2250/2250 [00:41<00:00, 54.58batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 54.70batch/s]
top1_score    0.731690
top3_score    0.943214
top5_score    0.973412
dtype: float64
valid_loss:  0.7982302410246848
Learning rate after epoch 25: [0.001424073892735471]
Epoch 26/28: 100%|██████████| 2250/2250 [00:42<00:00, 53.22batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 54.31batch/s]
top1_score    0.734144
top3_score    0.943754
top5_score    0.973973
dtype: float64
valid_loss:  0.7941748398764731
Learning rate after epoch 26: [0.001424073892735471]
Epoch 27/28: 100%|██████████| 2250/2250 [00:40<00:00, 55.57batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.94batch/s]
top1_score    0.730584
top3_score    0.942604
top5_score    0.973030
dtype: float64
valid_loss:  0.8076376391452329
Learning rate after epoch 27: [0.001424073892735471]
Epoch 28/28: 100%|██████████| 2250/2250 [00:42<00:00, 52.77batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 54.46batch/s]
[I 2025-06-24 00:51:08,788] Trial 2 finished with value: 0.7341446876525879 and parameters: {'lr': 0.001424073892735471, 'weight_decay': 0.000556607727018623, 'num_epochs': 28, 'batch_size': 64, 'only_train_classifier': True, 'sched_patience': 13, 'sched_factor': 0.6709354569227064, 'sched_min_lr': 1e-06}. Best is trial 1 with value: 0.8901015520095825.
top1_score    0.732961
top3_score    0.942952
top5_score    0.973050
dtype: float64
valid_loss:  0.8085256424826797
Learning rate after epoch 28: [0.001424073892735471]
Training finished!
{'lr': 0.00012695791532814832, 'weight_decay': 0.0010475750594742207, 'num_epochs': 29, 'batch_size': 64, 'only_train_classifier': False, 'sched_patience': 11, 'sched_factor': 0.5054137635000718, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/29: 100%|██████████| 2250/2250 [00:44<00:00, 50.55batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.56batch/s]
top1_score    0.844137
top3_score    0.988103
top5_score    0.996968
dtype: float64
valid_loss:  0.3796136801132724
Learning rate after epoch 1: [0.00012695791532814832]
Epoch 2/29: 100%|██████████| 2250/2250 [00:43<00:00, 51.30batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 56.04batch/s]
top1_score    0.862031
top3_score    0.990661
top5_score    0.997705
dtype: float64
valid_loss:  0.3411781791180743
Learning rate after epoch 2: [0.00012695791532814832]
Epoch 3/29: 100%|██████████| 2250/2250 [00:43<00:00, 52.25batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 58.79batch/s]
top1_score    0.858918
top3_score    0.990924
top5_score    0.998007
dtype: float64
valid_loss:  0.336698668702881
Learning rate after epoch 3: [0.00012695791532814832]
Epoch 4/29: 100%|██████████| 2250/2250 [00:43<00:00, 52.28batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.96batch/s]
top1_score    0.867134
top3_score    0.991725
top5_score    0.998480
dtype: float64
valid_loss:  0.31853151257889306
Learning rate after epoch 4: [0.00012695791532814832]
Epoch 5/29: 100%|██████████| 2250/2250 [00:43<00:00, 52.14batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 58.25batch/s]
top1_score    0.870981
top3_score    0.991502
top5_score    0.998121
dtype: float64
valid_loss:  0.3171199520861277
Learning rate after epoch 5: [0.00012695791532814832]
Epoch 6/29: 100%|██████████| 2250/2250 [00:44<00:00, 50.05batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 55.15batch/s]
top1_score    0.871993
top3_score    0.990894
top5_score    0.998313
dtype: float64
valid_loss:  0.31766600754661206
Learning rate after epoch 6: [0.00012695791532814832]
Epoch 7/29: 100%|██████████| 2250/2250 [00:43<00:00, 51.28batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.94batch/s]
top1_score    0.877343
top3_score    0.991829
top5_score    0.998432
dtype: float64
valid_loss:  0.3060881966066615
Learning rate after epoch 7: [0.00012695791532814832]
Epoch 8/29: 100%|██████████| 2250/2250 [00:43<00:00, 52.03batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 55.69batch/s]
top1_score    0.873329
top3_score    0.992713
top5_score    0.998564
dtype: float64
valid_loss:  0.3177891669672505
Learning rate after epoch 8: [0.00012695791532814832]
Epoch 9/29: 100%|██████████| 2250/2250 [00:43<00:00, 52.12batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 56.21batch/s]
top1_score    0.873785
top3_score    0.992093
top5_score    0.998642
dtype: float64
valid_loss:  0.3165149248567398
Learning rate after epoch 9: [0.00012695791532814832]
Epoch 10/29: 100%|██████████| 2250/2250 [00:44<00:00, 50.85batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.00batch/s]
top1_score    0.883524
top3_score    0.992949
top5_score    0.998229
dtype: float64
valid_loss:  0.3062679105128954
Learning rate after epoch 10: [0.00012695791532814832]
Epoch 11/29: 100%|██████████| 2250/2250 [00:44<00:00, 51.11batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 56.74batch/s]
top1_score    0.884851
top3_score    0.992442
top5_score    0.998364
dtype: float64
valid_loss:  0.315504692137559
Learning rate after epoch 11: [0.00012695791532814832]
Epoch 12/29: 100%|██████████| 2250/2250 [00:44<00:00, 50.58batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.45batch/s]
top1_score    0.884446
top3_score    0.991928
top5_score    0.998400
dtype: float64
valid_loss:  0.32247876766308164
Learning rate after epoch 12: [0.00012695791532814832]
Epoch 13/29: 100%|██████████| 2250/2250 [00:43<00:00, 52.10batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.38batch/s]
top1_score    0.887498
top3_score    0.991522
top5_score    0.998094
dtype: float64
valid_loss:  0.3378247363727745
Learning rate after epoch 13: [0.00012695791532814832]
Epoch 14/29: 100%|██████████| 2250/2250 [00:43<00:00, 51.35batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.75batch/s]
top1_score    0.888043
top3_score    0.991737
top5_score    0.997880
dtype: float64
valid_loss:  0.34599019446762586
Learning rate after epoch 14: [0.00012695791532814832]
Epoch 15/29: 100%|██████████| 2250/2250 [00:42<00:00, 52.86batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.65batch/s]
top1_score    0.891230
top3_score    0.992077
top5_score    0.997782
dtype: float64
valid_loss:  0.35747208661973795
Learning rate after epoch 15: [0.00012695791532814832]
Epoch 16/29: 100%|██████████| 2250/2250 [00:42<00:00, 52.49batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 58.30batch/s]
top1_score    0.889530
top3_score    0.992210
top5_score    0.997684
dtype: float64
valid_loss:  0.36219524289109145
Learning rate after epoch 16: [0.00012695791532814832]
Epoch 17/29: 100%|██████████| 2250/2250 [00:42<00:00, 52.54batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 56.67batch/s]
top1_score    0.890948
top3_score    0.990546
top5_score    0.997682
dtype: float64
valid_loss:  0.3713837138262989
Learning rate after epoch 17: [0.00012695791532814832]
Epoch 18/29: 100%|██████████| 2250/2250 [00:43<00:00, 51.72batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.92batch/s]
top1_score    0.890091
top3_score    0.991169
top5_score    0.997709
dtype: float64
valid_loss:  0.3763337142328809
Learning rate after epoch 18: [0.00012695791532814832]
Epoch 19/29: 100%|██████████| 2250/2250 [00:43<00:00, 51.70batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 58.00batch/s]
top1_score    0.893550
top3_score    0.992617
top5_score    0.997986
dtype: float64
valid_loss:  0.37774218775027596
Learning rate after epoch 19: [6.41662777921229e-05]
Epoch 20/29: 100%|██████████| 2250/2250 [00:42<00:00, 52.55batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 58.73batch/s]
top1_score    0.902513
top3_score    0.992253
top5_score    0.997551
dtype: float64
valid_loss:  0.3892825027633306
Learning rate after epoch 20: [6.41662777921229e-05]
Epoch 21/29: 100%|██████████| 2250/2250 [00:43<00:00, 51.85batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.45batch/s]
top1_score    0.899893
top3_score    0.991218
top5_score    0.997189
dtype: float64
valid_loss:  0.4219442394232877
Learning rate after epoch 21: [6.41662777921229e-05]
Epoch 22/29: 100%|██████████| 2250/2250 [00:44<00:00, 50.36batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.71batch/s]
top1_score    0.899942
top3_score    0.989652
top5_score    0.996917
dtype: float64
valid_loss:  0.4591609901594756
Learning rate after epoch 22: [6.41662777921229e-05]
Epoch 23/29: 100%|██████████| 2250/2250 [00:43<00:00, 51.83batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.73batch/s]
top1_score    0.901885
top3_score    0.990918
top5_score    0.997052
dtype: float64
valid_loss:  0.4618131047045253
Learning rate after epoch 23: [6.41662777921229e-05]
Epoch 24/29: 100%|██████████| 2250/2250 [00:42<00:00, 52.59batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 56.58batch/s]
top1_score    0.900143
top3_score    0.989870
top5_score    0.996805
dtype: float64
valid_loss:  0.505198404537001
Learning rate after epoch 24: [6.41662777921229e-05]
Epoch 25/29: 100%|██████████| 2250/2250 [00:43<00:00, 51.47batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.86batch/s]
top1_score    0.901136
top3_score    0.989361
top5_score    0.996393
dtype: float64
valid_loss:  0.5003827144648237
Learning rate after epoch 25: [6.41662777921229e-05]
Epoch 26/29: 100%|██████████| 2250/2250 [00:42<00:00, 52.72batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.08batch/s]
top1_score    0.900525
top3_score    0.988177
top5_score    0.996258
dtype: float64
valid_loss:  0.5126180765715297
Learning rate after epoch 26: [6.41662777921229e-05]
Epoch 27/29: 100%|██████████| 2250/2250 [00:43<00:00, 51.86batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 58.93batch/s]
top1_score    0.900888
top3_score    0.989397
top5_score    0.996424
dtype: float64
valid_loss:  0.534162646238932
Learning rate after epoch 27: [6.41662777921229e-05]
Epoch 28/29: 100%|██████████| 2250/2250 [00:42<00:00, 52.84batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.73batch/s]
top1_score    0.900433
top3_score    0.988467
top5_score    0.995639
dtype: float64
valid_loss:  0.5567823701817708
Learning rate after epoch 28: [6.41662777921229e-05]
Epoch 29/29: 100%|██████████| 2250/2250 [00:42<00:00, 52.40batch/s]

Model validation...
100%|██████████| 563/563 [00:09<00:00, 57.47batch/s]
[I 2025-06-24 01:16:54,403] Trial 3 finished with value: 0.9030842185020447 and parameters: {'lr': 0.00012695791532814832, 'weight_decay': 0.0010475750594742207, 'num_epochs': 29, 'batch_size': 64, 'only_train_classifier': False, 'sched_patience': 11, 'sched_factor': 0.5054137635000718, 'sched_min_lr': 1e-06}. Best is trial 3 with value: 0.9030842185020447.
top1_score    0.903084
top3_score    0.988072
top5_score    0.996113
dtype: float64
valid_loss:  0.560760341697169
Learning rate after epoch 29: [6.41662777921229e-05]
Training finished!
{'lr': 2.2361536288901506e-05, 'weight_decay': 0.0034478770614722316, 'num_epochs': 18, 'batch_size': 16, 'only_train_classifier': False, 'sched_patience': 3, 'sched_factor': 0.13872139583231197, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/18: 100%|██████████| 9000/9000 [01:26<00:00, 104.59batch/s]

Model validation...
100%|██████████| 2250/2250 [00:15<00:00, 143.92batch/s]
top1_score    0.846424
top3_score    0.987003
top5_score    0.996111
dtype: float64
valid_loss:  0.37855753269253506
Learning rate after epoch 1: [2.2361536288901506e-05]
Epoch 2/18: 100%|██████████| 9000/9000 [01:25<00:00, 105.77batch/s]

Model validation...
100%|██████████| 2250/2250 [00:17<00:00, 127.17batch/s]
top1_score    0.861235
top3_score    0.990215
top5_score    0.997730
dtype: float64
valid_loss:  0.33570047553690774
Learning rate after epoch 2: [2.2361536288901506e-05]
Epoch 3/18: 100%|██████████| 9000/9000 [01:42<00:00, 87.41batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 123.33batch/s]
top1_score    0.864996
top3_score    0.991138
top5_score    0.998033
dtype: float64
valid_loss:  0.3267093180105504
Learning rate after epoch 3: [2.2361536288901506e-05]
Epoch 4/18: 100%|██████████| 9000/9000 [01:42<00:00, 88.05batch/s]

Model validation...
100%|██████████| 2250/2250 [00:16<00:00, 134.78batch/s]
top1_score    0.867707
top3_score    0.991222
top5_score    0.998171
dtype: float64
valid_loss:  0.3179683973085549
Learning rate after epoch 4: [2.2361536288901506e-05]
Epoch 5/18: 100%|██████████| 9000/9000 [01:44<00:00, 86.34batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 121.83batch/s]
top1_score    0.873549
top3_score    0.990795
top5_score    0.998149
dtype: float64
valid_loss:  0.31120449688927165
Learning rate after epoch 5: [2.2361536288901506e-05]
Epoch 6/18: 100%|██████████| 9000/9000 [01:53<00:00, 79.26batch/s]

Model validation...
100%|██████████| 2250/2250 [00:27<00:00, 80.46batch/s]
top1_score    0.874788
top3_score    0.992329
top5_score    0.998537
dtype: float64
valid_loss:  0.30672971013892025
Learning rate after epoch 6: [2.2361536288901506e-05]
Epoch 7/18: 100%|██████████| 9000/9000 [01:52<00:00, 80.13batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 122.43batch/s]
top1_score    0.882206
top3_score    0.991942
top5_score    0.998236
dtype: float64
valid_loss:  0.30319604427864155
Learning rate after epoch 7: [2.2361536288901506e-05]
Epoch 8/18: 100%|██████████| 9000/9000 [01:46<00:00, 84.76batch/s]

Model validation...
100%|██████████| 2250/2250 [00:16<00:00, 134.12batch/s]
top1_score    0.877028
top3_score    0.992126
top5_score    0.998319
dtype: float64
valid_loss:  0.3096863820493066
Learning rate after epoch 8: [2.2361536288901506e-05]
Epoch 9/18: 100%|██████████| 9000/9000 [01:42<00:00, 87.92batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 122.82batch/s]
top1_score    0.878816
top3_score    0.992185
top5_score    0.998119
dtype: float64
valid_loss:  0.30704540318188567
Learning rate after epoch 9: [2.2361536288901506e-05]
Epoch 10/18: 100%|██████████| 9000/9000 [01:44<00:00, 86.27batch/s]

Model validation...
100%|██████████| 2250/2250 [00:19<00:00, 113.74batch/s]
top1_score    0.880827
top3_score    0.992747
top5_score    0.998257
dtype: float64
valid_loss:  0.3163603902768551
Learning rate after epoch 10: [2.2361536288901506e-05]
Epoch 11/18: 100%|██████████| 9000/9000 [01:40<00:00, 89.67batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 121.55batch/s]
top1_score    0.885317
top3_score    0.991897
top5_score    0.998173
dtype: float64
valid_loss:  0.30804510801443313
Learning rate after epoch 11: [3.1020235269513143e-06]
Epoch 12/18: 100%|██████████| 9000/9000 [01:44<00:00, 86.00batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 122.18batch/s]
top1_score    0.892050
top3_score    0.992363
top5_score    0.998394
dtype: float64
valid_loss:  0.3055976517171754
Learning rate after epoch 12: [3.1020235269513143e-06]
Epoch 13/18: 100%|██████████| 9000/9000 [01:41<00:00, 88.96batch/s]

Model validation...
100%|██████████| 2250/2250 [00:19<00:00, 113.99batch/s]
top1_score    0.894606
top3_score    0.992701
top5_score    0.998533
dtype: float64
valid_loss:  0.3095997829049334
Learning rate after epoch 13: [3.1020235269513143e-06]
Epoch 14/18: 100%|██████████| 9000/9000 [01:47<00:00, 83.73batch/s]

Model validation...
100%|██████████| 2250/2250 [00:19<00:00, 114.81batch/s]
top1_score    0.896833
top3_score    0.992566
top5_score    0.998285
dtype: float64
valid_loss:  0.3095672216482667
Learning rate after epoch 14: [3.1020235269513143e-06]
Epoch 15/18: 100%|██████████| 9000/9000 [01:38<00:00, 91.11batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 123.33batch/s]
top1_score    0.895147
top3_score    0.991804
top5_score    0.998170
dtype: float64
valid_loss:  0.32174037146146617
Learning rate after epoch 15: [1e-06]
Epoch 16/18: 100%|██████████| 9000/9000 [01:45<00:00, 85.61batch/s]

Model validation...
100%|██████████| 2250/2250 [00:26<00:00, 83.75batch/s]
top1_score    0.895706
top3_score    0.992464
top5_score    0.998011
dtype: float64
valid_loss:  0.3226436581763426
Learning rate after epoch 16: [1e-06]
Epoch 17/18: 100%|██████████| 9000/9000 [03:44<00:00, 40.08batch/s]

Model validation...
100%|██████████| 2250/2250 [01:01<00:00, 36.43batch/s]
top1_score    0.895777
top3_score    0.992168
top5_score    0.998149
dtype: float64
valid_loss:  0.325367497522177
Learning rate after epoch 17: [1e-06]
Epoch 18/18: 100%|██████████| 9000/9000 [03:42<00:00, 40.53batch/s]

Model validation...
100%|██████████| 2250/2250 [01:00<00:00, 37.43batch/s]
[I 2025-06-24 01:58:49,979] Trial 4 finished with value: 0.8981946706771851 and parameters: {'lr': 2.2361536288901506e-05, 'weight_decay': 0.0034478770614722316, 'num_epochs': 18, 'batch_size': 16, 'only_train_classifier': False, 'sched_patience': 3, 'sched_factor': 0.13872139583231197, 'sched_min_lr': 1e-06}. Best is trial 3 with value: 0.9030842185020447.
top1_score    0.898195
top3_score    0.991827
top5_score    0.998064
dtype: float64
valid_loss:  0.32405376912460065
Learning rate after epoch 18: [1e-06]
Training finished!
{'lr': 0.0001896863976509664, 'weight_decay': 0.0007122086354050508, 'num_epochs': 29, 'batch_size': 32, 'only_train_classifier': False, 'sched_patience': 2, 'sched_factor': 0.8964940867725847, 'sched_min_lr': 1e-05, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/29: 100%|██████████| 4500/4500 [02:30<00:00, 29.94batch/s]

Model validation...
100%|██████████| 1125/1125 [00:42<00:00, 26.36batch/s]
top1_score    0.847791
top3_score    0.989525
top5_score    0.997540
dtype: float64
valid_loss:  0.3668299670683013
Learning rate after epoch 1: [0.0001896863976509664]
Epoch 2/29: 100%|██████████| 4500/4500 [02:34<00:00, 29.16batch/s]

Model validation...
100%|██████████| 1125/1125 [00:38<00:00, 28.94batch/s]
top1_score    0.858425
top3_score    0.990604
top5_score    0.997895
dtype: float64
valid_loss:  0.3498711330493291
Learning rate after epoch 2: [0.0001896863976509664]
Epoch 3/29: 100%|██████████| 4500/4500 [02:28<00:00, 30.29batch/s]

Model validation...
100%|██████████| 1125/1125 [00:39<00:00, 28.74batch/s]
[I 2025-06-24 02:08:24,347] Trial 5 pruned.
top1_score    0.856759
top3_score    0.990747
top5_score    0.998122
dtype: float64
valid_loss:  0.3469562445481618
Learning rate after epoch 3: [0.0001896863976509664]
{'lr': 0.00018139538685696662, 'weight_decay': 0.00027082411459755244, 'num_epochs': 28, 'batch_size': 64, 'only_train_classifier': False, 'sched_patience': 10, 'sched_factor': 0.25091620738576337, 'sched_min_lr': 1e-05, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/28: 100%|██████████| 2250/2250 [01:49<00:00, 20.52batch/s]

Model validation...
100%|██████████| 563/563 [00:29<00:00, 18.99batch/s]
top1_score    0.847906
top3_score    0.988791
top5_score    0.997838
dtype: float64
valid_loss:  0.36722411869050764
Learning rate after epoch 1: [0.00018139538685696662]
Epoch 2/28: 100%|██████████| 2250/2250 [01:43<00:00, 21.75batch/s]

Model validation...
100%|██████████| 563/563 [00:17<00:00, 31.65batch/s]
top1_score    0.848511
top3_score    0.989897
top5_score    0.997928
dtype: float64
valid_loss:  0.36044942840377986
Learning rate after epoch 2: [0.00018139538685696662]
Epoch 3/28: 100%|██████████| 2250/2250 [00:54<00:00, 41.65batch/s]

Model validation...
100%|██████████| 563/563 [00:11<00:00, 47.13batch/s]
top1_score    0.864743
top3_score    0.991490
top5_score    0.998044
dtype: float64
valid_loss:  0.3269786458217653
Learning rate after epoch 3: [0.00018139538685696662]
Epoch 4/28: 100%|██████████| 2250/2250 [00:48<00:00, 46.61batch/s]

Model validation...
100%|██████████| 563/563 [00:15<00:00, 36.66batch/s]
top1_score    0.865091
top3_score    0.991100
top5_score    0.998451
dtype: float64
valid_loss:  0.32343736105659715
Learning rate after epoch 4: [0.00018139538685696662]
Epoch 5/28: 100%|██████████| 2250/2250 [02:12<00:00, 17.03batch/s]

Model validation...
100%|██████████| 563/563 [00:58<00:00,  9.55batch/s]
top1_score    0.872867
top3_score    0.992535
top5_score    0.998750
dtype: float64
valid_loss:  0.3121106865589191
Learning rate after epoch 5: [0.00018139538685696662]
Epoch 6/28: 100%|██████████| 2250/2250 [01:29<00:00, 25.22batch/s]

Model validation...
100%|██████████| 563/563 [00:12<00:00, 44.33batch/s]
top1_score    0.873163
top3_score    0.991944
top5_score    0.998517
dtype: float64
valid_loss:  0.30705370869136833
Learning rate after epoch 6: [0.00018139538685696662]
Epoch 7/28: 100%|██████████| 2250/2250 [00:49<00:00, 45.76batch/s]

Model validation...
100%|██████████| 563/563 [00:11<00:00, 48.65batch/s]
[I 2025-06-24 02:20:48,753] Trial 6 pruned.
top1_score    0.871547
top3_score    0.992167
top5_score    0.998339
dtype: float64
valid_loss:  0.3145698595983944
Learning rate after epoch 7: [0.00018139538685696662]
{'lr': 2.6302551618884935e-05, 'weight_decay': 0.0001298099717048418, 'num_epochs': 27, 'batch_size': 64, 'only_train_classifier': False, 'sched_patience': 2, 'sched_factor': 0.225570495229697, 'sched_min_lr': 1e-05, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/27: 100%|██████████| 2250/2250 [00:48<00:00, 46.39batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 53.28batch/s]
top1_score    0.849668
top3_score    0.985796
top5_score    0.995847
dtype: float64
valid_loss:  0.38154573206579706
Learning rate after epoch 1: [2.6302551618884935e-05]
Epoch 2/27: 100%|██████████| 2250/2250 [00:50<00:00, 44.31batch/s]

Model validation...
100%|██████████| 563/563 [00:16<00:00, 35.01batch/s]
top1_score    0.857639
top3_score    0.989678
top5_score    0.997571
dtype: float64
valid_loss:  0.3449863516733871
Learning rate after epoch 2: [2.6302551618884935e-05]
Epoch 3/27: 100%|██████████| 2250/2250 [01:29<00:00, 25.22batch/s]

Model validation...
100%|██████████| 563/563 [01:00<00:00,  9.29batch/s]
top1_score    0.864609
top3_score    0.990368
top5_score    0.998068
dtype: float64
valid_loss:  0.32935320719626615
Learning rate after epoch 3: [2.6302551618884935e-05]
Epoch 4/27: 100%|██████████| 2250/2250 [03:57<00:00,  9.49batch/s]

Model validation...
100%|██████████| 563/563 [01:00<00:00,  9.28batch/s]
top1_score    0.869293
top3_score    0.992224
top5_score    0.998449
dtype: float64
valid_loss:  0.31651742727252563
Learning rate after epoch 4: [2.6302551618884935e-05]
Epoch 5/27: 100%|██████████| 2250/2250 [03:57<00:00,  9.46batch/s]

Model validation...
100%|██████████| 563/563 [01:01<00:00,  9.21batch/s]
top1_score    0.871512
top3_score    0.991717
top5_score    0.998267
dtype: float64
valid_loss:  0.3140870708158342
Learning rate after epoch 5: [2.6302551618884935e-05]
Epoch 6/27: 100%|██████████| 2250/2250 [04:28<00:00,  8.38batch/s]

Model validation...
100%|██████████| 563/563 [01:09<00:00,  8.14batch/s]
[I 2025-06-24 02:40:59,305] Trial 7 pruned.
top1_score    0.871041
top3_score    0.991774
top5_score    0.998232
dtype: float64
valid_loss:  0.31776629188503297
Learning rate after epoch 6: [2.6302551618884935e-05]
{'lr': 0.006321833515253147, 'weight_decay': 0.0007029779895172358, 'num_epochs': 12, 'batch_size': 16, 'only_train_classifier': False, 'sched_patience': 11, 'sched_factor': 0.6445641534677744, 'sched_min_lr': 1e-05, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/12: 100%|██████████| 9000/9000 [05:55<00:00, 25.30batch/s]

Model validation...
100%|██████████| 2250/2250 [01:19<00:00, 28.13batch/s]
top1_score    0.820181
top3_score    0.982503
top5_score    0.995202
dtype: float64
valid_loss:  0.4316909169289801
Learning rate after epoch 1: [0.006321833515253147]
Epoch 2/12: 100%|██████████| 9000/9000 [05:35<00:00, 26.86batch/s]

Model validation...
100%|██████████| 2250/2250 [01:23<00:00, 27.10batch/s]
top1_score    0.844688
top3_score    0.986947
top5_score    0.996430
dtype: float64
valid_loss:  0.3778768483574192
Learning rate after epoch 2: [0.006321833515253147]
Epoch 3/12: 100%|██████████| 9000/9000 [03:10<00:00, 47.25batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 120.25batch/s]
[I 2025-06-24 02:58:42,763] Trial 8 pruned.
top1_score    0.849660
top3_score    0.988554
top5_score    0.996739
dtype: float64
valid_loss:  0.35688428933028543
Learning rate after epoch 3: [0.006321833515253147]
{'lr': 6.659698179430549e-05, 'weight_decay': 0.0017165014243042322, 'num_epochs': 34, 'batch_size': 64, 'only_train_classifier': True, 'sched_patience': 11, 'sched_factor': 0.5090237296773836, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/34: 100%|██████████| 2250/2250 [00:44<00:00, 51.10batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 51.68batch/s]
top1_score    0.534989
top3_score    0.798943
top5_score    0.877478
dtype: float64
valid_loss:  1.7136900280974474
Learning rate after epoch 1: [6.659698179430549e-05]
Epoch 2/34: 100%|██████████| 2250/2250 [00:44<00:00, 51.04batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 52.27batch/s]
top1_score    0.607773
top3_score    0.857075
top5_score    0.918260
dtype: float64
valid_loss:  1.3497188369715405
Learning rate after epoch 2: [6.659698179430549e-05]
Epoch 3/34: 100%|██████████| 2250/2250 [00:42<00:00, 52.70batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 52.59batch/s]
[I 2025-06-24 03:01:26,249] Trial 9 pruned.
top1_score    0.639830
top3_score    0.879654
top5_score    0.933733
dtype: float64
valid_loss:  1.1941736343698857
Learning rate after epoch 3: [6.659698179430549e-05]
{'lr': 0.0009664602788257607, 'weight_decay': 0.005181361882461865, 'num_epochs': 35, 'batch_size': 64, 'only_train_classifier': True, 'sched_patience': 6, 'sched_factor': 0.385353002980582, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/35: 100%|██████████| 2250/2250 [00:43<00:00, 51.31batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 52.79batch/s]
top1_score    0.676262
top3_score    0.903503
top5_score    0.949598
dtype: float64
valid_loss:  1.012789514517911
Learning rate after epoch 1: [0.0009664602788257607]
Epoch 2/35: 100%|██████████| 2250/2250 [00:43<00:00, 51.42batch/s]

Model validation...
100%|██████████| 563/563 [00:12<00:00, 44.00batch/s]
top1_score    0.698662
top3_score    0.918851
top5_score    0.958764
dtype: float64
valid_loss:  0.9229575284950263
Learning rate after epoch 2: [0.0009664602788257607]
Epoch 3/35: 100%|██████████| 2250/2250 [00:49<00:00, 45.01batch/s]

Model validation...
100%|██████████| 563/563 [00:14<00:00, 40.00batch/s]
[I 2025-06-24 03:04:21,692] Trial 10 pruned.
top1_score    0.705849
top3_score    0.924399
top5_score    0.962593
dtype: float64
valid_loss:  0.8969531042325983
Learning rate after epoch 3: [0.0009664602788257607]
{'lr': 5.933767416207546e-05, 'weight_decay': 0.008582316605953984, 'num_epochs': 21, 'batch_size': 16, 'only_train_classifier': False, 'sched_patience': 15, 'sched_factor': 0.1118448703171866, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/21: 100%|██████████| 9000/9000 [01:39<00:00, 90.63batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 121.56batch/s]
top1_score    0.848631
top3_score    0.988479
top5_score    0.997379
dtype: float64
valid_loss:  0.3655382280713982
Learning rate after epoch 1: [5.933767416207546e-05]
Epoch 2/21: 100%|██████████| 9000/9000 [01:44<00:00, 86.39batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 121.23batch/s]
top1_score    0.849153
top3_score    0.990575
top5_score    0.997873
dtype: float64
valid_loss:  0.3486617679239975
Learning rate after epoch 2: [5.933767416207546e-05]
Epoch 3/21: 100%|██████████| 9000/9000 [01:40<00:00, 89.61batch/s]

Model validation...
100%|██████████| 2250/2250 [00:17<00:00, 128.37batch/s]
top1_score    0.866586
top3_score    0.991121
top5_score    0.998118
dtype: float64
valid_loss:  0.3205956220014228
Learning rate after epoch 3: [5.933767416207546e-05]
Epoch 4/21: 100%|██████████| 9000/9000 [01:43<00:00, 86.80batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 121.59batch/s]
top1_score    0.865981
top3_score    0.990588
top5_score    0.998370
dtype: float64
valid_loss:  0.3186266462372409
Learning rate after epoch 4: [5.933767416207546e-05]
Epoch 5/21: 100%|██████████| 9000/9000 [01:41<00:00, 88.71batch/s]

Model validation...
100%|██████████| 2250/2250 [00:16<00:00, 134.69batch/s]
top1_score    0.873010
top3_score    0.992400
top5_score    0.998507
dtype: float64
valid_loss:  0.30684755992672097
Learning rate after epoch 5: [5.933767416207546e-05]
Epoch 6/21: 100%|██████████| 9000/9000 [01:43<00:00, 87.05batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 123.55batch/s]
top1_score    0.872777
top3_score    0.992169
top5_score    0.998618
dtype: float64
valid_loss:  0.3088549645870096
Learning rate after epoch 6: [5.933767416207546e-05]
Epoch 7/21: 100%|██████████| 9000/9000 [01:44<00:00, 85.90batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 121.76batch/s]
[I 2025-06-24 03:18:25,869] Trial 11 pruned.
top1_score    0.873964
top3_score    0.992426
top5_score    0.998456
dtype: float64
valid_loss:  0.3105706932530221
Learning rate after epoch 7: [5.933767416207546e-05]
{'lr': 6.57924543907976e-05, 'weight_decay': 0.0028842786898892717, 'num_epochs': 22, 'batch_size': 16, 'only_train_classifier': False, 'sched_patience': 5, 'sched_factor': 0.45399051711787436, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/22: 100%|██████████| 9000/9000 [01:38<00:00, 91.15batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 122.92batch/s]
top1_score    0.844119
top3_score    0.987550
top5_score    0.997115
dtype: float64
valid_loss:  0.3819741116853224
Learning rate after epoch 1: [6.57924543907976e-05]
Epoch 2/22: 100%|██████████| 9000/9000 [01:44<00:00, 86.36batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 123.05batch/s]
top1_score    0.854679
top3_score    0.989611
top5_score    0.998033
dtype: float64
valid_loss:  0.34407884964253754
Learning rate after epoch 2: [6.57924543907976e-05]
Epoch 3/22: 100%|██████████| 9000/9000 [01:49<00:00, 82.21batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 119.01batch/s]
top1_score    0.863889
top3_score    0.991606
top5_score    0.998370
dtype: float64
valid_loss:  0.32195940714412263
Learning rate after epoch 3: [6.57924543907976e-05]
Epoch 4/22: 100%|██████████| 9000/9000 [01:43<00:00, 86.73batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 121.89batch/s]
top1_score    0.866333
top3_score    0.992043
top5_score    0.998503
dtype: float64
valid_loss:  0.3179581322327463
Learning rate after epoch 4: [6.57924543907976e-05]
Epoch 5/22: 100%|██████████| 9000/9000 [01:38<00:00, 91.06batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 123.17batch/s]
top1_score    0.872532
top3_score    0.992574
top5_score    0.998651
dtype: float64
valid_loss:  0.3118228783818583
Learning rate after epoch 5: [6.57924543907976e-05]
Epoch 6/22: 100%|██████████| 9000/9000 [01:43<00:00, 86.66batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 122.26batch/s]
top1_score    0.874074
top3_score    0.992736
top5_score    0.998593
dtype: float64
valid_loss:  0.30791943775779673
Learning rate after epoch 6: [6.57924543907976e-05]
Epoch 7/22: 100%|██████████| 9000/9000 [01:36<00:00, 92.86batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 122.20batch/s]
[I 2025-06-24 03:32:31,140] Trial 12 pruned.
top1_score    0.875386
top3_score    0.991842
top5_score    0.998473
dtype: float64
valid_loss:  0.31111664631755814
Learning rate after epoch 7: [6.57924543907976e-05]
{'lr': 0.00045368560718394825, 'weight_decay': 0.003540896511965858, 'num_epochs': 20, 'batch_size': 16, 'only_train_classifier': False, 'sched_patience': 8, 'sched_factor': 0.3378783216781554, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/20: 100%|██████████| 9000/9000 [01:45<00:00, 85.54batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 121.75batch/s]
top1_score    0.829547
top3_score    0.983824
top5_score    0.995661
dtype: float64
valid_loss:  0.4162840993011163
Learning rate after epoch 1: [0.00045368560718394825]
Epoch 2/20: 100%|██████████| 9000/9000 [01:39<00:00, 90.59batch/s]

Model validation...
100%|██████████| 2250/2250 [00:16<00:00, 135.14batch/s]
top1_score    0.855589
top3_score    0.989544
top5_score    0.997451
dtype: float64
valid_loss:  0.35839969697180724
Learning rate after epoch 2: [0.00045368560718394825]
Epoch 3/20: 100%|██████████| 9000/9000 [01:42<00:00, 87.43batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 120.92batch/s]
top1_score    0.859419
top3_score    0.989867
top5_score    0.997626
dtype: float64
valid_loss:  0.3412765821330249
Learning rate after epoch 3: [0.00045368560718394825]
Epoch 4/20: 100%|██████████| 9000/9000 [01:44<00:00, 86.00batch/s]

Model validation...
100%|██████████| 2250/2250 [00:16<00:00, 133.40batch/s]
top1_score    0.865359
top3_score    0.991161
top5_score    0.998038
dtype: float64
valid_loss:  0.3254549211582376
Learning rate after epoch 4: [0.00045368560718394825]
Epoch 5/20: 100%|██████████| 9000/9000 [01:41<00:00, 88.51batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 121.43batch/s]
[I 2025-06-24 03:42:34,476] Trial 13 pruned.
top1_score    0.868123
top3_score    0.990366
top5_score    0.998149
dtype: float64
valid_loss:  0.3200796434852398
Learning rate after epoch 5: [0.00045368560718394825]
{'lr': 3.287960379631763e-05, 'weight_decay': 0.0013201093866817626, 'num_epochs': 25, 'batch_size': 32, 'only_train_classifier': False, 'sched_patience': 4, 'sched_factor': 0.5506939900584097, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/25: 100%|██████████| 4500/4500 [01:05<00:00, 68.50batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.36batch/s]
top1_score    0.849123
top3_score    0.986932
top5_score    0.996713
dtype: float64
valid_loss:  0.36792604578203625
Learning rate after epoch 1: [3.287960379631763e-05]
Epoch 2/25: 100%|██████████| 4500/4500 [01:03<00:00, 70.81batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 91.52batch/s]
top1_score    0.862187
top3_score    0.990383
top5_score    0.998090
dtype: float64
valid_loss:  0.3327320298022694
Learning rate after epoch 2: [3.287960379631763e-05]
Epoch 3/25: 100%|██████████| 4500/4500 [01:07<00:00, 67.01batch/s]

Model validation...
100%|██████████| 1125/1125 [00:16<00:00, 69.15batch/s]
top1_score    0.866365
top3_score    0.991713
top5_score    0.998338
dtype: float64
valid_loss:  0.31937204240759215
Learning rate after epoch 3: [3.287960379631763e-05]
Epoch 4/25: 100%|██████████| 4500/4500 [01:07<00:00, 67.12batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 86.64batch/s]
top1_score    0.870220
top3_score    0.991449
top5_score    0.998339
dtype: float64
valid_loss:  0.3157872002191014
Learning rate after epoch 4: [3.287960379631763e-05]
Epoch 5/25: 100%|██████████| 4500/4500 [01:06<00:00, 68.17batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 90.19batch/s]
top1_score    0.870988
top3_score    0.991678
top5_score    0.998420
dtype: float64
valid_loss:  0.31377762843502893
Learning rate after epoch 5: [3.287960379631763e-05]
Epoch 6/25: 100%|██████████| 4500/4500 [01:03<00:00, 71.15batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.89batch/s]
top1_score    0.876931
top3_score    0.991991
top5_score    0.998504
dtype: float64
valid_loss:  0.3029772755702337
Learning rate after epoch 6: [3.287960379631763e-05]
Epoch 7/25: 100%|██████████| 4500/4500 [01:07<00:00, 66.53batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.12batch/s]
top1_score    0.879892
top3_score    0.991973
top5_score    0.998670
dtype: float64
valid_loss:  0.3044539786544111
Learning rate after epoch 7: [3.287960379631763e-05]
Epoch 8/25: 100%|██████████| 4500/4500 [01:07<00:00, 67.15batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 84.55batch/s]
top1_score    0.881669
top3_score    0.992504
top5_score    0.998364
dtype: float64
valid_loss:  0.30545666641824776
Learning rate after epoch 8: [3.287960379631763e-05]
Epoch 9/25: 100%|██████████| 4500/4500 [01:01<00:00, 73.27batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.38batch/s]
top1_score    0.883959
top3_score    0.992233
top5_score    0.998532
dtype: float64
valid_loss:  0.30364670186738174
Learning rate after epoch 9: [3.287960379631763e-05]
Epoch 10/25: 100%|██████████| 4500/4500 [01:06<00:00, 67.70batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.24batch/s]
top1_score    0.882006
top3_score    0.992862
top5_score    0.998423
dtype: float64
valid_loss:  0.3224329825805293
Learning rate after epoch 10: [3.287960379631763e-05]
Epoch 11/25: 100%|██████████| 4500/4500 [01:05<00:00, 68.38batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.81batch/s]
top1_score    0.888235
top3_score    0.992140
top5_score    0.998231
dtype: float64
valid_loss:  0.31226230488717555
Learning rate after epoch 11: [1.8106600206133793e-05]
Epoch 12/25: 100%|██████████| 4500/4500 [01:04<00:00, 69.95batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 90.74batch/s]
top1_score    0.890066
top3_score    0.991930
top5_score    0.998140
dtype: float64
valid_loss:  0.3289059214786523
Learning rate after epoch 12: [1.8106600206133793e-05]
Epoch 13/25: 100%|██████████| 4500/4500 [01:06<00:00, 67.62batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.13batch/s]
top1_score    0.890798
top3_score    0.992336
top5_score    0.998254
dtype: float64
valid_loss:  0.3364502686088284
Learning rate after epoch 13: [1.8106600206133793e-05]
Epoch 14/25: 100%|██████████| 4500/4500 [01:08<00:00, 66.10batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 86.91batch/s]
top1_score    0.894802
top3_score    0.992159
top5_score    0.998012
dtype: float64
valid_loss:  0.3368990157031351
Learning rate after epoch 14: [1.8106600206133793e-05]
Epoch 15/25: 100%|██████████| 4500/4500 [01:08<00:00, 66.09batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 89.35batch/s]
top1_score    0.893651
top3_score    0.991531
top5_score    0.997677
dtype: float64
valid_loss:  0.35668982047732506
Learning rate after epoch 15: [1.8106600206133793e-05]
Epoch 16/25: 100%|██████████| 4500/4500 [01:03<00:00, 71.27batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.34batch/s]
top1_score    0.894536
top3_score    0.991944
top5_score    0.998030
dtype: float64
valid_loss:  0.354603390129697
Learning rate after epoch 16: [9.971195913908241e-06]
Epoch 17/25: 100%|██████████| 4500/4500 [01:07<00:00, 67.12batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.51batch/s]
top1_score    0.899643
top3_score    0.991809
top5_score    0.997709
dtype: float64
valid_loss:  0.3618462256544994
Learning rate after epoch 17: [9.971195913908241e-06]
Epoch 18/25: 100%|██████████| 4500/4500 [01:06<00:00, 68.16batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.41batch/s]
top1_score    0.900199
top3_score    0.990883
top5_score    0.997540
dtype: float64
valid_loss:  0.381208363168252
Learning rate after epoch 18: [9.971195913908241e-06]
Epoch 19/25: 100%|██████████| 4500/4500 [01:01<00:00, 73.00batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 87.04batch/s]
top1_score    0.899891
top3_score    0.990277
top5_score    0.997394
dtype: float64
valid_loss:  0.3966798722040322
Learning rate after epoch 19: [9.971195913908241e-06]
Epoch 20/25: 100%|██████████| 4500/4500 [01:06<00:00, 67.29batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 86.90batch/s]
top1_score    0.900650
top3_score    0.990762
top5_score    0.997284
dtype: float64
valid_loss:  0.39748253670681477
Learning rate after epoch 20: [9.971195913908241e-06]
Epoch 21/25: 100%|██████████| 4500/4500 [01:05<00:00, 68.35batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 86.67batch/s]
top1_score    0.901963
top3_score    0.990021
top5_score    0.997310
dtype: float64
valid_loss:  0.3987462885779225
Learning rate after epoch 21: [5.49107766348424e-06]
Epoch 22/25: 100%|██████████| 4500/4500 [01:04<00:00, 69.58batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 89.72batch/s]
top1_score    0.899650
top3_score    0.990365
top5_score    0.997148
dtype: float64
valid_loss:  0.4218000376911627
Learning rate after epoch 22: [5.49107766348424e-06]
Epoch 23/25: 100%|██████████| 4500/4500 [01:06<00:00, 67.32batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.71batch/s]
top1_score    0.903469
top3_score    0.989302
top5_score    0.996765
dtype: float64
valid_loss:  0.4192981518570127
Learning rate after epoch 23: [5.49107766348424e-06]
Epoch 24/25: 100%|██████████| 4500/4500 [01:06<00:00, 67.60batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.11batch/s]
top1_score    0.901435
top3_score    0.989229
top5_score    0.996618
dtype: float64
valid_loss:  0.42940431935686824
Learning rate after epoch 24: [5.49107766348424e-06]
Epoch 25/25: 100%|██████████| 4500/4500 [01:07<00:00, 67.06batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.38batch/s]
[I 2025-06-24 04:15:26,044] Trial 14 finished with value: 0.903468668460846 and parameters: {'lr': 3.287960379631763e-05, 'weight_decay': 0.0013201093866817626, 'num_epochs': 25, 'batch_size': 32, 'only_train_classifier': False, 'sched_patience': 4, 'sched_factor': 0.5506939900584097, 'sched_min_lr': 1e-06}. Best is trial 14 with value: 0.903468668460846.
top1_score    0.903170
top3_score    0.989809
top5_score    0.996648
dtype: float64
valid_loss:  0.4514997136557682
Learning rate after epoch 25: [5.49107766348424e-06]
Training finished!
{'lr': 0.00010664938098888373, 'weight_decay': 0.0012877575961197816, 'num_epochs': 24, 'batch_size': 32, 'only_train_classifier': False, 'sched_patience': 4, 'sched_factor': 0.546815199519135, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/24: 100%|██████████| 4500/4500 [01:03<00:00, 71.27batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.06batch/s]
top1_score    0.852115
top3_score    0.988412
top5_score    0.996993
dtype: float64
valid_loss:  0.358265539030234
Learning rate after epoch 1: [0.00010664938098888373]
Epoch 2/24: 100%|██████████| 4500/4500 [01:06<00:00, 68.16batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.24batch/s]
top1_score    0.852818
top3_score    0.989945
top5_score    0.997902
dtype: float64
valid_loss:  0.3494685050580237
Learning rate after epoch 2: [0.00010664938098888373]
Epoch 3/24: 100%|██████████| 4500/4500 [01:06<00:00, 67.19batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.83batch/s]
top1_score    0.863516
top3_score    0.991359
top5_score    0.998308
dtype: float64
valid_loss:  0.32763463550806043
Learning rate after epoch 3: [0.00010664938098888373]
Epoch 4/24: 100%|██████████| 4500/4500 [01:03<00:00, 71.14batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 88.11batch/s]
[I 2025-06-24 04:20:37,936] Trial 15 pruned.
top1_score    0.860637
top3_score    0.990713
top5_score    0.998200
dtype: float64
valid_loss:  0.32667084892921977
Learning rate after epoch 4: [0.00010664938098888373]
{'lr': 0.0004147240967008969, 'weight_decay': 0.0003297121306751305, 'num_epochs': 32, 'batch_size': 32, 'only_train_classifier': False, 'sched_patience': 9, 'sched_factor': 0.5896911939122301, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/32: 100%|██████████| 4500/4500 [01:06<00:00, 67.98batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.16batch/s]
top1_score    0.829472
top3_score    0.984661
top5_score    0.995224
dtype: float64
valid_loss:  0.414301874352826
Learning rate after epoch 1: [0.0004147240967008969]
Epoch 2/32: 100%|██████████| 4500/4500 [01:06<00:00, 68.01batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.45batch/s]
top1_score    0.84763
top3_score    0.98712
top5_score    0.99725
dtype: float64
valid_loss:  0.36579757585790423
Learning rate after epoch 2: [0.0004147240967008969]
Epoch 3/32: 100%|██████████| 4500/4500 [01:06<00:00, 68.14batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 91.79batch/s]
top1_score    0.860373
top3_score    0.990223
top5_score    0.998046
dtype: float64
valid_loss:  0.34074113163020875
Learning rate after epoch 3: [0.0004147240967008969]
Epoch 4/32: 100%|██████████| 4500/4500 [01:04<00:00, 69.47batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.57batch/s]
[I 2025-06-24 04:25:53,078] Trial 16 pruned.
top1_score    0.860954
top3_score    0.989497
top5_score    0.997824
dtype: float64
valid_loss:  0.3361430581212044
Learning rate after epoch 4: [0.0004147240967008969]
{'lr': 3.4513893468946567e-05, 'weight_decay': 0.0010228478668447068, 'num_epochs': 25, 'batch_size': 32, 'only_train_classifier': False, 'sched_patience': 7, 'sched_factor': 0.7637368988443772, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/25: 100%|██████████| 4500/4500 [01:07<00:00, 66.23batch/s]

Model validation...
100%|██████████| 1125/1125 [00:15<00:00, 74.01batch/s]
top1_score    0.851583
top3_score    0.988642
top5_score    0.997233
dtype: float64
valid_loss:  0.3666234391927719
Learning rate after epoch 1: [3.4513893468946567e-05]
Epoch 2/25: 100%|██████████| 4500/4500 [01:05<00:00, 68.33batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.91batch/s]
top1_score    0.860966
top3_score    0.990968
top5_score    0.997872
dtype: float64
valid_loss:  0.3329018405675888
Learning rate after epoch 2: [3.4513893468946567e-05]
Epoch 3/25: 100%|██████████| 4500/4500 [01:01<00:00, 73.05batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.22batch/s]
top1_score    0.862399
top3_score    0.990813
top5_score    0.998087
dtype: float64
valid_loss:  0.3266333031720585
Learning rate after epoch 3: [3.4513893468946567e-05]
Epoch 4/25: 100%|██████████| 4500/4500 [01:06<00:00, 67.85batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 84.79batch/s]
top1_score    0.872636
top3_score    0.992253
top5_score    0.998528
dtype: float64
valid_loss:  0.3114469796717167
Learning rate after epoch 4: [3.4513893468946567e-05]
Epoch 5/25: 100%|██████████| 4500/4500 [01:06<00:00, 67.35batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.90batch/s]
top1_score    0.876704
top3_score    0.992146
top5_score    0.998395
dtype: float64
valid_loss:  0.3100817599693934
Learning rate after epoch 5: [3.4513893468946567e-05]
Epoch 6/25: 100%|██████████| 4500/4500 [01:02<00:00, 72.41batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 89.95batch/s]
top1_score    0.876836
top3_score    0.992226
top5_score    0.998342
dtype: float64
valid_loss:  0.3067623285022047
Learning rate after epoch 6: [3.4513893468946567e-05]
Epoch 7/25: 100%|██████████| 4500/4500 [01:10<00:00, 64.17batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 84.77batch/s]
top1_score    0.876291
top3_score    0.992405
top5_score    0.998310
dtype: float64
valid_loss:  0.3111164908044868
Learning rate after epoch 7: [3.4513893468946567e-05]
Epoch 8/25: 100%|██████████| 4500/4500 [01:05<00:00, 68.23batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.35batch/s]
top1_score    0.881997
top3_score    0.992789
top5_score    0.998339
dtype: float64
valid_loss:  0.3085336573272944
Learning rate after epoch 8: [3.4513893468946567e-05]
Epoch 9/25: 100%|██████████| 4500/4500 [01:06<00:00, 68.14batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 91.56batch/s]
top1_score    0.884336
top3_score    0.993097
top5_score    0.998317
dtype: float64
valid_loss:  0.3082281266815133
Learning rate after epoch 9: [3.4513893468946567e-05]
Epoch 10/25: 100%|██████████| 4500/4500 [01:03<00:00, 71.35batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.62batch/s]
top1_score    0.881331
top3_score    0.992857
top5_score    0.998202
dtype: float64
valid_loss:  0.31546830601576303
Learning rate after epoch 10: [3.4513893468946567e-05]
Epoch 11/25: 100%|██████████| 4500/4500 [01:05<00:00, 68.20batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.51batch/s]
top1_score    0.889718
top3_score    0.992107
top5_score    0.998201
dtype: float64
valid_loss:  0.3139324452512794
Learning rate after epoch 11: [3.4513893468946567e-05]
Epoch 12/25: 100%|██████████| 4500/4500 [01:07<00:00, 66.95batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.35batch/s]
top1_score    0.889009
top3_score    0.992440
top5_score    0.998116
dtype: float64
valid_loss:  0.32403379310564034
Learning rate after epoch 12: [3.4513893468946567e-05]
Epoch 13/25: 100%|██████████| 4500/4500 [01:04<00:00, 70.16batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.20batch/s]
top1_score    0.890373
top3_score    0.992141
top5_score    0.998034
dtype: float64
valid_loss:  0.33000984446456033
Learning rate after epoch 13: [3.4513893468946567e-05]
Epoch 14/25: 100%|██████████| 4500/4500 [01:06<00:00, 67.80batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.58batch/s]
top1_score    0.890076
top3_score    0.992100
top5_score    0.998126
dtype: float64
valid_loss:  0.33447499741779435
Learning rate after epoch 14: [2.6359533965018454e-05]
Epoch 15/25: 100%|██████████| 4500/4500 [01:06<00:00, 67.66batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.05batch/s]
top1_score    0.896084
top3_score    0.991649
top5_score    0.997708
dtype: float64
valid_loss:  0.34193960225996045
Learning rate after epoch 15: [2.6359533965018454e-05]
Epoch 16/25: 100%|██████████| 4500/4500 [01:03<00:00, 70.96batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 89.81batch/s]
top1_score    0.895147
top3_score    0.991497
top5_score    0.998043
dtype: float64
valid_loss:  0.34776476269794837
Learning rate after epoch 16: [2.6359533965018454e-05]
Epoch 17/25: 100%|██████████| 4500/4500 [01:06<00:00, 67.70batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.78batch/s]
top1_score    0.892198
top3_score    0.990540
top5_score    0.997380
dtype: float64
valid_loss:  0.3731387116168626
Learning rate after epoch 17: [2.6359533965018454e-05]
Epoch 18/25: 100%|██████████| 4500/4500 [01:05<00:00, 68.35batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 84.67batch/s]
top1_score    0.896625
top3_score    0.991263
top5_score    0.997243
dtype: float64
valid_loss:  0.3726077704793877
Learning rate after epoch 18: [2.6359533965018454e-05]
Epoch 19/25: 100%|██████████| 4500/4500 [01:06<00:00, 67.92batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 92.41batch/s]
top1_score    0.895874
top3_score    0.989956
top5_score    0.997052
dtype: float64
valid_loss:  0.3885199335449272
Learning rate after epoch 19: [2.6359533965018454e-05]
Epoch 20/25: 100%|██████████| 4500/4500 [01:03<00:00, 70.45batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 84.68batch/s]
[I 2025-06-24 04:52:07,850] Trial 17 pruned.
top1_score    0.896037
top3_score    0.991223
top5_score    0.997260
dtype: float64
valid_loss:  0.3853785280177577
Learning rate after epoch 20: [2.6359533965018454e-05]
{'lr': 0.0001651159598890955, 'weight_decay': 0.0004907316157092207, 'num_epochs': 31, 'batch_size': 32, 'only_train_classifier': True, 'sched_patience': 13, 'sched_factor': 0.43662106634180353, 'sched_min_lr': 1e-05, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/31: 100%|██████████| 4500/4500 [00:56<00:00, 79.34batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.15batch/s]
top1_score    0.633129
top3_score    0.871670
top5_score    0.928656
dtype: float64
valid_loss:  1.1941705159081353
Learning rate after epoch 1: [0.0001651159598890955]
Epoch 2/31: 100%|██████████| 4500/4500 [00:57<00:00, 78.07batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.50batch/s]
top1_score    0.672109
top3_score    0.899218
top5_score    0.946583
dtype: float64
valid_loss:  1.0311562503973644
Learning rate after epoch 2: [0.0001651159598890955]
Epoch 3/31: 100%|██████████| 4500/4500 [00:55<00:00, 81.42batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 90.68batch/s]
[I 2025-06-24 04:55:36,412] Trial 18 pruned.
top1_score    0.691448
top3_score    0.911924
top5_score    0.953478
dtype: float64
valid_loss:  0.9546763215065003
Learning rate after epoch 3: [0.0001651159598890955]
{'lr': 0.0063499339062178155, 'weight_decay': 0.0013091236251036673, 'num_epochs': 25, 'batch_size': 64, 'only_train_classifier': False, 'sched_patience': 5, 'sched_factor': 0.7344853832396313, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/25: 100%|██████████| 2250/2250 [00:48<00:00, 45.97batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 52.12batch/s]
top1_score    0.809660
top3_score    0.979091
top5_score    0.993373
dtype: float64
valid_loss:  0.4766641086890473
Learning rate after epoch 1: [0.0063499339062178155]
Epoch 2/25: 100%|██████████| 2250/2250 [00:48<00:00, 46.02batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 51.52batch/s]
top1_score    0.833928
top3_score    0.984293
top5_score    0.996328
dtype: float64
valid_loss:  0.4023428885646654
Learning rate after epoch 2: [0.0063499339062178155]
Epoch 3/25: 100%|██████████| 2250/2250 [00:49<00:00, 45.28batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 52.33batch/s]
[I 2025-06-24 04:58:36,759] Trial 19 pruned.
top1_score    0.839605
top3_score    0.987328
top5_score    0.997462
dtype: float64
valid_loss:  0.3784388262732203
Learning rate after epoch 3: [0.0063499339062178155]
{'lr': 1.0396137185202192e-05, 'weight_decay': 0.00035883620515629453, 'num_epochs': 31, 'batch_size': 64, 'only_train_classifier': False, 'sched_patience': 15, 'sched_factor': 0.3237735400891909, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/31: 100%|██████████| 2250/2250 [00:48<00:00, 46.64batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 53.57batch/s]
top1_score    0.826864
top3_score    0.980257
top5_score    0.992232
dtype: float64
valid_loss:  0.45399721530572135
Learning rate after epoch 1: [1.0396137185202192e-05]
Epoch 2/31: 100%|██████████| 2250/2250 [00:47<00:00, 47.54batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 51.86batch/s]
top1_score    0.849857
top3_score    0.986413
top5_score    0.995329
dtype: float64
valid_loss:  0.3788661733931377
Learning rate after epoch 2: [1.0396137185202192e-05]
Epoch 3/31: 100%|██████████| 2250/2250 [00:49<00:00, 45.89batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 51.40batch/s]
[I 2025-06-24 05:01:34,001] Trial 20 pruned.
top1_score    0.860179
top3_score    0.989077
top5_score    0.996521
dtype: float64
valid_loss:  0.34748113658246094
Learning rate after epoch 3: [1.0396137185202192e-05]
{'lr': 2.8342852678344863e-05, 'weight_decay': 0.002411416467661599, 'num_epochs': 19, 'batch_size': 16, 'only_train_classifier': False, 'sched_patience': 3, 'sched_factor': 0.12788208530292172, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/19: 100%|██████████| 9000/9000 [01:43<00:00, 86.80batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 121.53batch/s]
top1_score    0.847495
top3_score    0.987592
top5_score    0.996925
dtype: float64
valid_loss:  0.37016723603020524
Learning rate after epoch 1: [2.8342852678344863e-05]
Epoch 2/19: 100%|██████████| 9000/9000 [01:38<00:00, 91.39batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 122.95batch/s]
top1_score    0.858597
top3_score    0.990605
top5_score    0.998117
dtype: float64
valid_loss:  0.3344935585765375
Learning rate after epoch 2: [2.8342852678344863e-05]
Epoch 3/19: 100%|██████████| 9000/9000 [01:42<00:00, 87.58batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 123.31batch/s]
top1_score    0.862383
top3_score    0.990942
top5_score    0.998426
dtype: float64
valid_loss:  0.32763414057157936
Learning rate after epoch 3: [2.8342852678344863e-05]
Epoch 4/19: 100%|██████████| 9000/9000 [01:36<00:00, 92.92batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 122.71batch/s]
[I 2025-06-24 05:09:29,508] Trial 21 pruned.
top1_score    0.864441
top3_score    0.991990
top5_score    0.998338
dtype: float64
valid_loss:  0.3212347679200272
Learning rate after epoch 4: [2.8342852678344863e-05]
{'lr': 4.050795010590822e-05, 'weight_decay': 0.00490330708630773, 'num_epochs': 17, 'batch_size': 32, 'only_train_classifier': False, 'sched_patience': 4, 'sched_factor': 0.5767485936870241, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/17: 100%|██████████| 4500/4500 [01:07<00:00, 66.48batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.26batch/s]
top1_score    0.845737
top3_score    0.988759
top5_score    0.997149
dtype: float64
valid_loss:  0.3661568084425396
Learning rate after epoch 1: [4.050795010590822e-05]
Epoch 2/17: 100%|██████████| 4500/4500 [01:06<00:00, 67.72batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 84.18batch/s]
top1_score    0.856175
top3_score    0.989403
top5_score    0.998036
dtype: float64
valid_loss:  0.34837003835704594
Learning rate after epoch 2: [4.050795010590822e-05]
Epoch 3/17: 100%|██████████| 4500/4500 [01:01<00:00, 72.62batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.05batch/s]
top1_score    0.865534
top3_score    0.991070
top5_score    0.998182
dtype: float64
valid_loss:  0.3239422017898824
Learning rate after epoch 3: [4.050795010590822e-05]
Epoch 4/17: 100%|██████████| 4500/4500 [01:06<00:00, 67.37batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.01batch/s]
top1_score    0.870898
top3_score    0.991184
top5_score    0.998403
dtype: float64
valid_loss:  0.31518466850452953
Learning rate after epoch 4: [4.050795010590822e-05]
Epoch 5/17: 100%|██████████| 4500/4500 [01:06<00:00, 67.72batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.44batch/s]
top1_score    0.871193
top3_score    0.991847
top5_score    0.998535
dtype: float64
valid_loss:  0.3146169651614295
Learning rate after epoch 5: [4.050795010590822e-05]
Epoch 6/17: 100%|██████████| 4500/4500 [01:03<00:00, 70.42batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 91.36batch/s]
top1_score    0.878417
top3_score    0.992541
top5_score    0.998424
dtype: float64
valid_loss:  0.2969769314461284
Learning rate after epoch 6: [4.050795010590822e-05]
Epoch 7/17: 100%|██████████| 4500/4500 [01:05<00:00, 69.10batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.37batch/s]
top1_score    0.878047
top3_score    0.992624
top5_score    0.998487
dtype: float64
valid_loss:  0.3065218043608798
Learning rate after epoch 7: [4.050795010590822e-05]
Epoch 8/17: 100%|██████████| 4500/4500 [01:06<00:00, 67.25batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.20batch/s]
top1_score    0.882755
top3_score    0.992180
top5_score    0.998376
dtype: float64
valid_loss:  0.3063882050944699
Learning rate after epoch 8: [4.050795010590822e-05]
Epoch 9/17: 100%|██████████| 4500/4500 [01:06<00:00, 67.25batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 88.91batch/s]
top1_score    0.879220
top3_score    0.992180
top5_score    0.998461
dtype: float64
valid_loss:  0.3159978197813034
Learning rate after epoch 9: [4.050795010590822e-05]
Epoch 10/17: 100%|██████████| 4500/4500 [01:03<00:00, 71.42batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.33batch/s]
top1_score    0.884487
top3_score    0.991688
top5_score    0.998401
dtype: float64
valid_loss:  0.322519373005463
Learning rate after epoch 10: [4.050795010590822e-05]
Epoch 11/17: 100%|██████████| 4500/4500 [01:06<00:00, 67.80batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.93batch/s]
[I 2025-06-24 05:23:54,560] Trial 22 pruned.
top1_score    0.883545
top3_score    0.991559
top5_score    0.997878
dtype: float64
valid_loss:  0.32996032147606214
Learning rate after epoch 11: [2.3362903256726705e-05]
{'lr': 0.00010071428092633273, 'weight_decay': 0.0016287316147385127, 'num_epochs': 23, 'batch_size': 16, 'only_train_classifier': False, 'sched_patience': 3, 'sched_factor': 0.4739898401118791, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/23: 100%|██████████| 9000/9000 [01:42<00:00, 87.90batch/s]

Model validation...
100%|██████████| 2250/2250 [00:16<00:00, 136.36batch/s]
top1_score    0.850868
top3_score    0.988625
top5_score    0.997133
dtype: float64
valid_loss:  0.36488516756312717
Learning rate after epoch 1: [0.00010071428092633273]
Epoch 2/23: 100%|██████████| 9000/9000 [01:41<00:00, 88.80batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 121.67batch/s]
top1_score    0.852916
top3_score    0.990415
top5_score    0.998118
dtype: float64
valid_loss:  0.34611268477266033
Learning rate after epoch 2: [0.00010071428092633273]
Epoch 3/23: 100%|██████████| 9000/9000 [01:45<00:00, 85.54batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 120.61batch/s]
top1_score    0.868148
top3_score    0.990876
top5_score    0.997844
dtype: float64
valid_loss:  0.3196055855196383
Learning rate after epoch 3: [0.00010071428092633273]
Epoch 4/23: 100%|██████████| 9000/9000 [01:39<00:00, 90.02batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 120.36batch/s]
top1_score    0.870411
top3_score    0.991558
top5_score    0.998376
dtype: float64
valid_loss:  0.3163494395607461
Learning rate after epoch 4: [0.00010071428092633273]
Epoch 5/23: 100%|██████████| 9000/9000 [01:43<00:00, 86.69batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 121.18batch/s]
[I 2025-06-24 05:33:58,592] Trial 23 pruned.
top1_score    0.870030
top3_score    0.991729
top5_score    0.998448
dtype: float64
valid_loss:  0.3130968878848685
Learning rate after epoch 5: [0.00010071428092633273]
{'lr': 1.9446491020801645e-05, 'weight_decay': 0.009965327637124396, 'num_epochs': 26, 'batch_size': 16, 'only_train_classifier': False, 'sched_patience': 9, 'sched_factor': 0.38974514270426924, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/26: 100%|██████████| 9000/9000 [01:38<00:00, 91.79batch/s]

Model validation...
100%|██████████| 2250/2250 [00:20<00:00, 108.09batch/s]
top1_score    0.851967
top3_score    0.986792
top5_score    0.996048
dtype: float64
valid_loss:  0.37006984682050015
Learning rate after epoch 1: [1.9446491020801645e-05]
Epoch 2/26: 100%|██████████| 9000/9000 [01:43<00:00, 86.63batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 122.64batch/s]
top1_score    0.861865
top3_score    0.990395
top5_score    0.997732
dtype: float64
valid_loss:  0.3363882287345413
Learning rate after epoch 2: [1.9446491020801645e-05]
Epoch 3/26: 100%|██████████| 9000/9000 [01:42<00:00, 87.86batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 122.25batch/s]
top1_score    0.869351
top3_score    0.990988
top5_score    0.998092
dtype: float64
valid_loss:  0.3183279067609045
Learning rate after epoch 3: [1.9446491020801645e-05]
Epoch 4/26: 100%|██████████| 9000/9000 [01:42<00:00, 88.15batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 122.45batch/s]
top1_score    0.869272
top3_score    0.992450
top5_score    0.998259
dtype: float64
valid_loss:  0.31447810576028296
Learning rate after epoch 4: [1.9446491020801645e-05]
Epoch 5/26: 100%|██████████| 9000/9000 [01:38<00:00, 91.54batch/s]

Model validation...
100%|██████████| 2250/2250 [00:17<00:00, 126.56batch/s]
[I 2025-06-24 05:43:57,504] Trial 24 pruned.
top1_score    0.870829
top3_score    0.992235
top5_score    0.998564
dtype: float64
valid_loss:  0.3130761924634377
Learning rate after epoch 5: [1.9446491020801645e-05]
{'lr': 4.73050888739909e-05, 'weight_decay': 0.003943462932069468, 'num_epochs': 12, 'batch_size': 64, 'only_train_classifier': False, 'sched_patience': 6, 'sched_factor': 0.23972723462891207, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/12: 100%|██████████| 2250/2250 [00:48<00:00, 46.14batch/s]

Model validation...
100%|██████████| 563/563 [00:13<00:00, 41.94batch/s]
top1_score    0.849950
top3_score    0.988638
top5_score    0.996651
dtype: float64
valid_loss:  0.3659567774983113
Learning rate after epoch 1: [4.73050888739909e-05]
Epoch 2/12: 100%|██████████| 2250/2250 [00:48<00:00, 46.01batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 51.70batch/s]
top1_score    0.863373
top3_score    0.990312
top5_score    0.997615
dtype: float64
valid_loss:  0.3296549651328454
Learning rate after epoch 2: [4.73050888739909e-05]
Epoch 3/12: 100%|██████████| 2250/2250 [00:56<00:00, 40.12batch/s]

Model validation...
100%|██████████| 563/563 [00:15<00:00, 36.99batch/s]
top1_score    0.865886
top3_score    0.990336
top5_score    0.998093
dtype: float64
valid_loss:  0.32449204141198
Learning rate after epoch 3: [4.73050888739909e-05]
Epoch 4/12: 100%|██████████| 2250/2250 [00:52<00:00, 43.07batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 54.06batch/s]
top1_score    0.867752
top3_score    0.992161
top5_score    0.998426
dtype: float64
valid_loss:  0.31711022775507736
Learning rate after epoch 4: [4.73050888739909e-05]
Epoch 5/12: 100%|██████████| 2250/2250 [00:46<00:00, 48.00batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 51.68batch/s]
top1_score    0.874602
top3_score    0.991924
top5_score    0.998374
dtype: float64
valid_loss:  0.3106559785628827
Learning rate after epoch 5: [4.73050888739909e-05]
Epoch 6/12: 100%|██████████| 2250/2250 [00:48<00:00, 45.98batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 52.27batch/s]
top1_score    0.880752
top3_score    0.992163
top5_score    0.998562
dtype: float64
valid_loss:  0.3023695319917443
Learning rate after epoch 6: [4.73050888739909e-05]
Epoch 7/12: 100%|██████████| 2250/2250 [00:53<00:00, 42.34batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 51.62batch/s]
top1_score    0.872637
top3_score    0.992024
top5_score    0.998128
dtype: float64
valid_loss:  0.33054894918235117
Learning rate after epoch 7: [4.73050888739909e-05]
Epoch 8/12: 100%|██████████| 2250/2250 [00:48<00:00, 46.10batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 52.19batch/s]
top1_score    0.880197
top3_score    0.991530
top5_score    0.998172
dtype: float64
valid_loss:  0.313927308770416
Learning rate after epoch 8: [4.73050888739909e-05]
Epoch 9/12: 100%|██████████| 2250/2250 [00:46<00:00, 48.03batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 52.34batch/s]
top1_score    0.883592
top3_score    0.992896
top5_score    0.998340
dtype: float64
valid_loss:  0.317349263554568
Learning rate after epoch 9: [4.73050888739909e-05]
Epoch 10/12: 100%|██████████| 2250/2250 [00:50<00:00, 44.58batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 51.76batch/s]
top1_score    0.881447
top3_score    0.991429
top5_score    0.998260
dtype: float64
valid_loss:  0.33285270714024034
Learning rate after epoch 10: [4.73050888739909e-05]
Epoch 11/12: 100%|██████████| 2250/2250 [00:48<00:00, 46.01batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 52.19batch/s]
[I 2025-06-24 05:55:13,772] Trial 25 pruned.
top1_score    0.883781
top3_score    0.991859
top5_score    0.998204
dtype: float64
valid_loss:  0.3323324687950988
Learning rate after epoch 11: [4.73050888739909e-05]
{'lr': 0.00010399222647980494, 'weight_decay': 0.0009429230025353248, 'num_epochs': 30, 'batch_size': 32, 'only_train_classifier': True, 'sched_patience': 11, 'sched_factor': 0.5354775292560281, 'sched_min_lr': 1e-05, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/30: 100%|██████████| 4500/4500 [00:57<00:00, 78.34batch/s]

Model validation...
100%|██████████| 1125/1125 [00:15<00:00, 74.43batch/s]
top1_score    0.587131
top3_score    0.838998
top5_score    0.905304
dtype: float64
valid_loss:  1.3927260680728488
Learning rate after epoch 1: [0.00010399222647980494]
Epoch 2/30: 100%|██████████| 4500/4500 [00:58<00:00, 77.26batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.51batch/s]
top1_score    0.632834
top3_score    0.873714
top5_score    0.930083
dtype: float64
valid_loss:  1.1876392710473802
Learning rate after epoch 2: [0.00010399222647980494]
Epoch 3/30: 100%|██████████| 4500/4500 [00:58<00:00, 77.56batch/s]

Model validation...
100%|██████████| 1125/1125 [00:15<00:00, 71.16batch/s]
[I 2025-06-24 05:58:51,718] Trial 26 pruned.
top1_score    0.659492
top3_score    0.893417
top5_score    0.941959
dtype: float64
valid_loss:  1.0820153657595317
Learning rate after epoch 3: [0.00010399222647980494]
{'lr': 2.0521533068845042e-05, 'weight_decay': 0.006838871784376256, 'num_epochs': 18, 'batch_size': 32, 'only_train_classifier': False, 'sched_patience': 3, 'sched_factor': 0.6281971294641367, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/18: 100%|██████████| 4500/4500 [01:06<00:00, 67.90batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.83batch/s]
top1_score    0.847527
top3_score    0.986747
top5_score    0.995566
dtype: float64
valid_loss:  0.37755032741361194
Learning rate after epoch 1: [2.0521533068845042e-05]
Epoch 2/18: 100%|██████████| 4500/4500 [01:05<00:00, 68.88batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 90.96batch/s]
top1_score    0.860968
top3_score    0.990207
top5_score    0.997534
dtype: float64
valid_loss:  0.33885533909334076
Learning rate after epoch 2: [2.0521533068845042e-05]
Epoch 3/18: 100%|██████████| 4500/4500 [01:04<00:00, 69.54batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 87.15batch/s]
top1_score    0.865030
top3_score    0.990192
top5_score    0.997974
dtype: float64
valid_loss:  0.32675267123182616
Learning rate after epoch 3: [2.0521533068845042e-05]
Epoch 4/18: 100%|██████████| 4500/4500 [01:06<00:00, 67.96batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.77batch/s]
top1_score    0.867014
top3_score    0.990872
top5_score    0.998146
dtype: float64
valid_loss:  0.32238963923189373
Learning rate after epoch 4: [2.0521533068845042e-05]
Epoch 5/18: 100%|██████████| 4500/4500 [01:06<00:00, 67.54batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 86.83batch/s]
top1_score    0.871258
top3_score    0.991083
top5_score    0.997941
dtype: float64
valid_loss:  0.31958151808712215
Learning rate after epoch 5: [2.0521533068845042e-05]
Epoch 6/18: 100%|██████████| 4500/4500 [01:06<00:00, 68.07batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.50batch/s]
top1_score    0.875323
top3_score    0.992001
top5_score    0.998113
dtype: float64
valid_loss:  0.30992144732673965
Learning rate after epoch 6: [2.0521533068845042e-05]
Epoch 7/18: 100%|██████████| 4500/4500 [01:06<00:00, 68.01batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.76batch/s]
top1_score    0.878876
top3_score    0.991880
top5_score    0.998511
dtype: float64
valid_loss:  0.3110314180056254
Learning rate after epoch 7: [2.0521533068845042e-05]
Epoch 8/18: 100%|██████████| 4500/4500 [01:06<00:00, 68.12batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.41batch/s]
top1_score    0.881563
top3_score    0.991619
top5_score    0.998311
dtype: float64
valid_loss:  0.3047557953596115
Learning rate after epoch 8: [2.0521533068845042e-05]
Epoch 9/18: 100%|██████████| 4500/4500 [01:04<00:00, 69.93batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 82.82batch/s]
top1_score    0.882492
top3_score    0.991528
top5_score    0.998145
dtype: float64
valid_loss:  0.3173760240889258
Learning rate after epoch 9: [2.0521533068845042e-05]
Epoch 10/18: 100%|██████████| 4500/4500 [01:07<00:00, 67.12batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.34batch/s]
top1_score    0.879932
top3_score    0.991403
top5_score    0.997812
dtype: float64
valid_loss:  0.333380448313223
Learning rate after epoch 10: [2.0521533068845042e-05]
Epoch 11/18: 100%|██████████| 4500/4500 [01:09<00:00, 65.19batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.98batch/s]
top1_score    0.886170
top3_score    0.990612
top5_score    0.997767
dtype: float64
valid_loss:  0.31757135516901813
Learning rate after epoch 11: [2.0521533068845042e-05]
Epoch 12/18: 100%|██████████| 4500/4500 [01:04<00:00, 69.36batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 90.06batch/s]
top1_score    0.884604
top3_score    0.991163
top5_score    0.997846
dtype: float64
valid_loss:  0.3287037857870261
Learning rate after epoch 12: [1.2891568166051813e-05]
Epoch 13/18: 100%|██████████| 4500/4500 [01:04<00:00, 69.56batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.09batch/s]
top1_score    0.892184
top3_score    0.991360
top5_score    0.997618
dtype: float64
valid_loss:  0.32033757256633705
Learning rate after epoch 13: [1.2891568166051813e-05]
Epoch 14/18: 100%|██████████| 4500/4500 [01:05<00:00, 68.25batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 86.79batch/s]
top1_score    0.895081
top3_score    0.991179
top5_score    0.997620
dtype: float64
valid_loss:  0.3270582533385605
Learning rate after epoch 14: [1.2891568166051813e-05]
Epoch 15/18: 100%|██████████| 4500/4500 [01:05<00:00, 68.44batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.09batch/s]
top1_score    0.893846
top3_score    0.991723
top5_score    0.997484
dtype: float64
valid_loss:  0.3300454501989815
Learning rate after epoch 15: [1.2891568166051813e-05]
Epoch 16/18: 100%|██████████| 4500/4500 [01:01<00:00, 72.87batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 84.62batch/s]
top1_score    0.894459
top3_score    0.990566
top5_score    0.997184
dtype: float64
valid_loss:  0.3554657131112698
Learning rate after epoch 16: [8.098446116204995e-06]
Epoch 17/18: 100%|██████████| 4500/4500 [01:06<00:00, 67.50batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.56batch/s]
top1_score    0.898356
top3_score    0.990560
top5_score    0.997075
dtype: float64
valid_loss:  0.35813739903022845
Learning rate after epoch 17: [8.098446116204995e-06]
Epoch 18/18: 100%|██████████| 4500/4500 [01:05<00:00, 68.22batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.64batch/s]
[I 2025-06-24 06:22:30,703] Trial 27 finished with value: 0.8983563780784607 and parameters: {'lr': 2.0521533068845042e-05, 'weight_decay': 0.006838871784376256, 'num_epochs': 18, 'batch_size': 32, 'only_train_classifier': False, 'sched_patience': 3, 'sched_factor': 0.6281971294641367, 'sched_min_lr': 1e-06}. Best is trial 14 with value: 0.903468668460846.
top1_score    0.897916
top3_score    0.990637
top5_score    0.997077
dtype: float64
valid_loss:  0.3623064636008607
Learning rate after epoch 18: [8.098446116204995e-06]
Training finished!
{'lr': 0.0002324937649209513, 'weight_decay': 0.006617605156826687, 'num_epochs': 14, 'batch_size': 32, 'only_train_classifier': False, 'sched_patience': 5, 'sched_factor': 0.8105560876873336, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/14: 100%|██████████| 4500/4500 [01:03<00:00, 71.25batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 89.29batch/s]
top1_score    0.845810
top3_score    0.987370
top5_score    0.996907
dtype: float64
valid_loss:  0.37779789670970704
Learning rate after epoch 1: [0.0002324937649209513]
Epoch 2/14: 100%|██████████| 4500/4500 [01:11<00:00, 62.98batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.25batch/s]
top1_score    0.852285
top3_score    0.987172
top5_score    0.997486
dtype: float64
valid_loss:  0.36463166836235256
Learning rate after epoch 2: [0.0002324937649209513]
Epoch 3/14: 100%|██████████| 4500/4500 [01:06<00:00, 67.93batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 86.84batch/s]
top1_score    0.862956
top3_score    0.989925
top5_score    0.997901
dtype: float64
valid_loss:  0.33183893738190334
Learning rate after epoch 3: [0.0002324937649209513]
Epoch 4/14: 100%|██████████| 4500/4500 [01:04<00:00, 69.60batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 92.16batch/s]
[I 2025-06-24 06:27:47,495] Trial 28 pruned.
top1_score    0.864825
top3_score    0.990762
top5_score    0.998201
dtype: float64
valid_loss:  0.3247420944107903
Learning rate after epoch 4: [0.0002324937649209513]
{'lr': 1.0887316199602205e-05, 'weight_decay': 0.0020880509164394345, 'num_epochs': 15, 'batch_size': 32, 'only_train_classifier': True, 'sched_patience': 8, 'sched_factor': 0.605319168814627, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/15: 100%|██████████| 4500/4500 [00:56<00:00, 79.86batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.49batch/s]
top1_score    0.276073
top3_score    0.520702
top5_score    0.641507
dtype: float64
valid_loss:  2.7417093827989367
Learning rate after epoch 1: [1.0887316199602205e-05]
Epoch 2/15: 100%|██████████| 4500/4500 [00:57<00:00, 78.13batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 86.65batch/s]
top1_score    0.423645
top3_score    0.696097
top5_score    0.794201
dtype: float64
valid_loss:  2.2026768621868555
Learning rate after epoch 2: [1.0887316199602205e-05]
Epoch 3/15: 100%|██████████| 4500/4500 [00:56<00:00, 78.95batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.28batch/s]
[I 2025-06-24 06:31:18,077] Trial 29 pruned.
top1_score    0.494605
top3_score    0.762901
top5_score    0.848435
dtype: float64
valid_loss:  1.8907682246102226
Learning rate after epoch 3: [1.0887316199602205e-05]
{'lr': 0.0007036921712883663, 'weight_decay': 0.001022733555969806, 'num_epochs': 23, 'batch_size': 32, 'only_train_classifier': False, 'sched_patience': 7, 'sched_factor': 0.811488097385216, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/23: 100%|██████████| 4500/4500 [01:01<00:00, 72.65batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.49batch/s]
top1_score    0.817974
top3_score    0.984684
top5_score    0.995437
dtype: float64
valid_loss:  0.4411219558583366
Learning rate after epoch 1: [0.0007036921712883663]
Epoch 2/23: 100%|██████████| 4500/4500 [01:06<00:00, 67.73batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.21batch/s]
top1_score    0.840380
top3_score    0.987593
top5_score    0.996936
dtype: float64
valid_loss:  0.3769718105064498
Learning rate after epoch 2: [0.0007036921712883663]
Epoch 3/23: 100%|██████████| 4500/4500 [01:06<00:00, 67.52batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.16batch/s]
[I 2025-06-24 06:35:12,519] Trial 30 pruned.
top1_score    0.856959
top3_score    0.989609
top5_score    0.998260
dtype: float64
valid_loss:  0.3440267294446627
Learning rate after epoch 3: [0.0007036921712883663]
{'lr': 2.3712851060883536e-05, 'weight_decay': 0.006726659410850125, 'num_epochs': 19, 'batch_size': 16, 'only_train_classifier': False, 'sched_patience': 3, 'sched_factor': 0.7094188116628115, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/19: 100%|██████████| 9000/9000 [01:40<00:00, 89.58batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 121.78batch/s]
top1_score    0.847117
top3_score    0.987264
top5_score    0.996272
dtype: float64
valid_loss:  0.3761847795959976
Learning rate after epoch 1: [2.3712851060883536e-05]
Epoch 2/19: 100%|██████████| 9000/9000 [01:44<00:00, 86.47batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 121.90batch/s]
top1_score    0.859545
top3_score    0.989270
top5_score    0.997535
dtype: float64
valid_loss:  0.3435152468453679
Learning rate after epoch 2: [2.3712851060883536e-05]
Epoch 3/19: 100%|██████████| 9000/9000 [01:40<00:00, 89.52batch/s]

Model validation...
100%|██████████| 2250/2250 [00:17<00:00, 125.40batch/s]
top1_score    0.866590
top3_score    0.991574
top5_score    0.998344
dtype: float64
valid_loss:  0.3200096858566006
Learning rate after epoch 3: [2.3712851060883536e-05]
Epoch 4/19: 100%|██████████| 9000/9000 [01:44<00:00, 86.17batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 121.67batch/s]
top1_score    0.868934
top3_score    0.990888
top5_score    0.998232
dtype: float64
valid_loss:  0.319755475634502
Learning rate after epoch 4: [2.3712851060883536e-05]
Epoch 5/19: 100%|██████████| 9000/9000 [01:42<00:00, 88.20batch/s]

Model validation...
100%|██████████| 2250/2250 [00:16<00:00, 132.96batch/s]
top1_score    0.873438
top3_score    0.991136
top5_score    0.998350
dtype: float64
valid_loss:  0.31366807212587444
Learning rate after epoch 5: [2.3712851060883536e-05]
Epoch 6/19: 100%|██████████| 9000/9000 [01:42<00:00, 87.43batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 122.20batch/s]
[I 2025-06-24 06:47:16,156] Trial 31 pruned.
top1_score    0.873824
top3_score    0.992197
top5_score    0.998449
dtype: float64
valid_loss:  0.30489723279161585
Learning rate after epoch 6: [2.3712851060883536e-05]
{'lr': 1.5457633743307037e-05, 'weight_decay': 0.002687690825353188, 'num_epochs': 17, 'batch_size': 32, 'only_train_classifier': False, 'sched_patience': 2, 'sched_factor': 0.6273425862818802, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/17: 100%|██████████| 4500/4500 [01:06<00:00, 67.30batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.91batch/s]
top1_score    0.846496
top3_score    0.985887
top5_score    0.995527
dtype: float64
valid_loss:  0.38356153774923746
Learning rate after epoch 1: [1.5457633743307037e-05]
Epoch 2/17: 100%|██████████| 4500/4500 [01:02<00:00, 71.88batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 87.46batch/s]
top1_score    0.860125
top3_score    0.989354
top5_score    0.997592
dtype: float64
valid_loss:  0.3397434091038174
Learning rate after epoch 2: [1.5457633743307037e-05]
Epoch 3/17: 100%|██████████| 4500/4500 [01:06<00:00, 67.42batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.80batch/s]
top1_score    0.863458
top3_score    0.990468
top5_score    0.997871
dtype: float64
valid_loss:  0.32928212593661416
Learning rate after epoch 3: [1.5457633743307037e-05]
Epoch 4/17: 100%|██████████| 4500/4500 [01:06<00:00, 67.79batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.32batch/s]
top1_score    0.869411
top3_score    0.991572
top5_score    0.998124
dtype: float64
valid_loss:  0.31553211932049857
Learning rate after epoch 4: [1.5457633743307037e-05]
Epoch 5/17: 100%|██████████| 4500/4500 [01:07<00:00, 66.90batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 90.76batch/s]
[I 2025-06-24 06:53:51,028] Trial 32 pruned.
top1_score    0.870363
top3_score    0.990795
top5_score    0.998206
dtype: float64
valid_loss:  0.31678659305638734
Learning rate after epoch 5: [1.5457633743307037e-05]
{'lr': 1.8435005137316908e-05, 'weight_decay': 0.003435109409247313, 'num_epochs': 16, 'batch_size': 32, 'only_train_classifier': False, 'sched_patience': 4, 'sched_factor': 0.510244811661265, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/16: 100%|██████████| 4500/4500 [01:04<00:00, 69.52batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.17batch/s]
top1_score    0.846822
top3_score    0.986738
top5_score    0.995624
dtype: float64
valid_loss:  0.3829411280353864
Learning rate after epoch 1: [1.8435005137316908e-05]
Epoch 2/16: 100%|██████████| 4500/4500 [01:06<00:00, 68.04batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.00batch/s]
top1_score    0.859431
top3_score    0.989023
top5_score    0.997520
dtype: float64
valid_loss:  0.3460387996037801
Learning rate after epoch 2: [1.8435005137316908e-05]
Epoch 3/16: 100%|██████████| 4500/4500 [01:06<00:00, 68.08batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 86.54batch/s]
top1_score    0.868754
top3_score    0.991040
top5_score    0.998205
dtype: float64
valid_loss:  0.3226794933842288
Learning rate after epoch 3: [1.8435005137316908e-05]
Epoch 4/16: 100%|██████████| 4500/4500 [01:03<00:00, 71.18batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 84.96batch/s]
top1_score    0.870753
top3_score    0.991594
top5_score    0.998147
dtype: float64
valid_loss:  0.31633300223615435
Learning rate after epoch 4: [1.8435005137316908e-05]
Epoch 5/16: 100%|██████████| 4500/4500 [01:06<00:00, 67.68batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 86.78batch/s]
top1_score    0.871777
top3_score    0.991578
top5_score    0.998261
dtype: float64
valid_loss:  0.31575400812096066
Learning rate after epoch 5: [1.8435005137316908e-05]
Epoch 6/16: 100%|██████████| 4500/4500 [01:07<00:00, 66.85batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.28batch/s]
[I 2025-06-24 07:01:44,123] Trial 33 pruned.
top1_score    0.874083
top3_score    0.992168
top5_score    0.998476
dtype: float64
valid_loss:  0.30927435597115094
Learning rate after epoch 6: [1.8435005137316908e-05]
{'lr': 0.002841285674316948, 'weight_decay': 0.0017531668161278658, 'num_epochs': 19, 'batch_size': 64, 'only_train_classifier': False, 'sched_patience': 12, 'sched_factor': 0.6771365004002025, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/19: 100%|██████████| 2250/2250 [00:47<00:00, 47.54batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 53.41batch/s]
top1_score    0.836261
top3_score    0.983260
top5_score    0.995539
dtype: float64
valid_loss:  0.4176140740434399
Learning rate after epoch 1: [0.002841285674316948]
Epoch 2/19: 100%|██████████| 2250/2250 [00:48<00:00, 46.87batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 52.62batch/s]
top1_score    0.846769
top3_score    0.987767
top5_score    0.996462
dtype: float64
valid_loss:  0.3846250702337516
Learning rate after epoch 2: [0.002841285674316948]
Epoch 3/19: 100%|██████████| 2250/2250 [00:49<00:00, 45.61batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 52.02batch/s]
[I 2025-06-24 07:04:41,160] Trial 34 pruned.
top1_score    0.856622
top3_score    0.989526
top5_score    0.997481
dtype: float64
valid_loss:  0.35036919709314884
Learning rate after epoch 3: [0.002841285674316948]
{'lr': 3.8580323768052854e-05, 'weight_decay': 0.005577493647139475, 'num_epochs': 28, 'batch_size': 32, 'only_train_classifier': False, 'sched_patience': 3, 'sched_factor': 0.42547874508570194, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/28: 100%|██████████| 4500/4500 [01:06<00:00, 67.28batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 84.95batch/s]
top1_score    0.847877
top3_score    0.987413
top5_score    0.997066
dtype: float64
valid_loss:  0.36912792903184893
Learning rate after epoch 1: [3.8580323768052854e-05]
Epoch 2/28: 100%|██████████| 4500/4500 [01:03<00:00, 71.41batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 90.95batch/s]
top1_score    0.861381
top3_score    0.990529
top5_score    0.998060
dtype: float64
valid_loss:  0.33720874183707766
Learning rate after epoch 2: [3.8580323768052854e-05]
Epoch 3/28: 100%|██████████| 4500/4500 [01:08<00:00, 65.99batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.43batch/s]
top1_score    0.864298
top3_score    0.991037
top5_score    0.998006
dtype: float64
valid_loss:  0.3285373236801889
Learning rate after epoch 3: [3.8580323768052854e-05]
Epoch 4/28: 100%|██████████| 4500/4500 [01:06<00:00, 67.60batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.76batch/s]
[I 2025-06-24 07:09:58,113] Trial 35 pruned.
top1_score    0.863805
top3_score    0.991190
top5_score    0.998591
dtype: float64
valid_loss:  0.3232625049352646
Learning rate after epoch 4: [3.8580323768052854e-05]
{'lr': 1.3914368960824793e-05, 'weight_decay': 0.000621569496250045, 'num_epochs': 21, 'batch_size': 64, 'only_train_classifier': False, 'sched_patience': 2, 'sched_factor': 0.17885855719720323, 'sched_min_lr': 1e-05, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/21: 100%|██████████| 2250/2250 [00:53<00:00, 42.10batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 52.38batch/s]
top1_score    0.835070
top3_score    0.982773
top5_score    0.993809
dtype: float64
valid_loss:  0.4256901526112328
Learning rate after epoch 1: [1.3914368960824793e-05]
Epoch 2/21: 100%|██████████| 2250/2250 [00:45<00:00, 48.96batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 51.87batch/s]
top1_score    0.854315
top3_score    0.987555
top5_score    0.996050
dtype: float64
valid_loss:  0.36318195042188806
Learning rate after epoch 2: [1.3914368960824793e-05]
Epoch 3/21: 100%|██████████| 2250/2250 [00:48<00:00, 46.15batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 52.30batch/s]
[I 2025-06-24 07:12:58,933] Trial 36 pruned.
top1_score    0.860040
top3_score    0.988962
top5_score    0.997129
dtype: float64
valid_loss:  0.34124516792343945
Learning rate after epoch 3: [1.3914368960824793e-05]
{'lr': 7.843997348496108e-05, 'weight_decay': 0.0008113294640011312, 'num_epochs': 27, 'batch_size': 16, 'only_train_classifier': True, 'sched_patience': 4, 'sched_factor': 0.3182082050471001, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/27: 100%|██████████| 9000/9000 [01:27<00:00, 102.76batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 120.83batch/s]
top1_score    0.555151
top3_score    0.815835
top5_score    0.892033
dtype: float64
valid_loss:  1.5135681948661803
Learning rate after epoch 1: [7.843997348496108e-05]
Epoch 2/27: 100%|██████████| 9000/9000 [01:20<00:00, 111.76batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 121.07batch/s]
top1_score    0.604902
top3_score    0.854614
top5_score    0.918843
dtype: float64
valid_loss:  1.2915503780444464
Learning rate after epoch 2: [7.843997348496108e-05]
Epoch 3/27: 100%|██████████| 9000/9000 [01:27<00:00, 102.94batch/s]

Model validation...
100%|██████████| 2250/2250 [00:18<00:00, 123.54batch/s]
[I 2025-06-24 07:18:10,228] Trial 37 pruned.
top1_score    0.629388
top3_score    0.873562
top5_score    0.929901
dtype: float64
valid_loss:  1.193087303797404
Learning rate after epoch 3: [7.843997348496108e-05]
{'lr': 2.503115921526102e-05, 'weight_decay': 0.00010217338600683377, 'num_epochs': 29, 'batch_size': 64, 'only_train_classifier': False, 'sched_patience': 10, 'sched_factor': 0.5521034046236989, 'sched_min_lr': 1e-05, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/29: 100%|██████████| 2250/2250 [00:48<00:00, 46.20batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 52.51batch/s]
top1_score    0.848517
top3_score    0.986787
top5_score    0.996106
dtype: float64
valid_loss:  0.37618951001874507
Learning rate after epoch 1: [2.503115921526102e-05]
Epoch 2/29: 100%|██████████| 2250/2250 [00:47<00:00, 47.28batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 51.97batch/s]
top1_score    0.863271
top3_score    0.989322
top5_score    0.997643
dtype: float64
valid_loss:  0.3357046009645157
Learning rate after epoch 2: [2.503115921526102e-05]
Epoch 3/29: 100%|██████████| 2250/2250 [00:48<00:00, 46.70batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 51.87batch/s]
top1_score    0.867745
top3_score    0.991163
top5_score    0.997894
dtype: float64
valid_loss:  0.3281095267718469
Learning rate after epoch 3: [2.503115921526102e-05]
Epoch 4/29: 100%|██████████| 2250/2250 [00:48<00:00, 46.18batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 52.34batch/s]
top1_score    0.869557
top3_score    0.991813
top5_score    0.998236
dtype: float64
valid_loss:  0.31524447977648745
Learning rate after epoch 4: [2.503115921526102e-05]
Epoch 5/29: 100%|██████████| 2250/2250 [00:49<00:00, 45.46batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 52.11batch/s]
top1_score    0.871582
top3_score    0.991718
top5_score    0.998122
dtype: float64
valid_loss:  0.32014520862015694
Learning rate after epoch 5: [2.503115921526102e-05]
Epoch 6/29: 100%|██████████| 2250/2250 [00:48<00:00, 46.73batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 53.46batch/s]
top1_score    0.875218
top3_score    0.991808
top5_score    0.998261
dtype: float64
valid_loss:  0.31351625981540493
Learning rate after epoch 6: [2.503115921526102e-05]
Epoch 7/29: 100%|██████████| 2250/2250 [00:47<00:00, 47.45batch/s]

Model validation...
100%|██████████| 563/563 [00:15<00:00, 36.79batch/s]
top1_score    0.877780
top3_score    0.991350
top5_score    0.998347
dtype: float64
valid_loss:  0.3139788893317774
Learning rate after epoch 7: [2.503115921526102e-05]
Epoch 8/29: 100%|██████████| 2250/2250 [00:51<00:00, 43.60batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 52.23batch/s]
top1_score    0.880298
top3_score    0.991946
top5_score    0.997955
dtype: float64
valid_loss:  0.31553964531231093
Learning rate after epoch 8: [2.503115921526102e-05]
Epoch 9/29: 100%|██████████| 2250/2250 [00:48<00:00, 45.97batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 52.26batch/s]
top1_score    0.882909
top3_score    0.991335
top5_score    0.997684
dtype: float64
valid_loss:  0.3243333412397183
Learning rate after epoch 9: [2.503115921526102e-05]
Epoch 10/29: 100%|██████████| 2250/2250 [00:48<00:00, 46.49batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 51.89batch/s]
top1_score    0.887621
top3_score    0.991592
top5_score    0.997928
dtype: float64
valid_loss:  0.31610057941020914
Learning rate after epoch 10: [2.503115921526102e-05]
Epoch 11/29: 100%|██████████| 2250/2250 [00:46<00:00, 47.96batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 53.05batch/s]
top1_score    0.888365
top3_score    0.991192
top5_score    0.997570
dtype: float64
valid_loss:  0.3244177431635704
Learning rate after epoch 11: [2.503115921526102e-05]
Epoch 12/29: 100%|██████████| 2250/2250 [00:48<00:00, 46.04batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 52.04batch/s]
top1_score    0.886574
top3_score    0.990271
top5_score    0.997520
dtype: float64
valid_loss:  0.3360453212160624
Learning rate after epoch 12: [2.503115921526102e-05]
Epoch 13/29: 100%|██████████| 2250/2250 [00:48<00:00, 45.99batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 52.20batch/s]
top1_score    0.888408
top3_score    0.990658
top5_score    0.997515
dtype: float64
valid_loss:  0.3432347639786414
Learning rate after epoch 13: [2.503115921526102e-05]
Epoch 14/29: 100%|██████████| 2250/2250 [00:48<00:00, 45.97batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 52.35batch/s]
top1_score    0.892462
top3_score    0.990864
top5_score    0.997465
dtype: float64
valid_loss:  0.34129428242202553
Learning rate after epoch 14: [2.503115921526102e-05]
Epoch 15/29: 100%|██████████| 2250/2250 [00:48<00:00, 46.10batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 53.96batch/s]
top1_score    0.891012
top3_score    0.989990
top5_score    0.997075
dtype: float64
valid_loss:  0.34374490754801257
Learning rate after epoch 15: [2.503115921526102e-05]
Epoch 16/29: 100%|██████████| 2250/2250 [00:51<00:00, 43.55batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 51.70batch/s]
top1_score    0.892174
top3_score    0.990205
top5_score    0.997189
dtype: float64
valid_loss:  0.3602026596427176
Learning rate after epoch 16: [2.503115921526102e-05]
Epoch 17/29: 100%|██████████| 2250/2250 [00:48<00:00, 46.48batch/s]

Model validation...
100%|██████████| 563/563 [00:10<00:00, 52.16batch/s]
[I 2025-06-24 07:35:08,028] Trial 38 pruned.
top1_score    0.890823
top3_score    0.989860
top5_score    0.997022
dtype: float64
valid_loss:  0.3767524167339501
Learning rate after epoch 17: [1.3819788224423483e-05]
{'lr': 0.00014505153386332084, 'weight_decay': 0.0004778765324030755, 'num_epochs': 14, 'batch_size': 32, 'only_train_classifier': False, 'sched_patience': 6, 'sched_factor': 0.6592063106419512, 'sched_min_lr': 1e-06, 'train_with_CombinedClassifier': False, 'probabilities': [1, 1, 1, 1], 'config_CombinedClassifier': None}


-------------- Start New Training: ---------------


Epoch 1/14: 100%|██████████| 4500/4500 [01:07<00:00, 66.99batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.59batch/s]
top1_score    0.844997
top3_score    0.984847
top5_score    0.997403
dtype: float64
valid_loss:  0.3783133789234691
Learning rate after epoch 1: [0.00014505153386332084]
Epoch 2/14: 100%|██████████| 4500/4500 [01:05<00:00, 68.49batch/s]

Model validation...
100%|██████████| 1125/1125 [00:12<00:00, 91.65batch/s]
top1_score    0.860508
top3_score    0.990868
top5_score    0.998228
dtype: float64
valid_loss:  0.3356551181475321
Learning rate after epoch 2: [0.00014505153386332084]
Epoch 3/14: 100%|██████████| 4500/4500 [01:04<00:00, 69.66batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.83batch/s]
top1_score    0.862859
top3_score    0.990382
top5_score    0.998123
dtype: float64
valid_loss:  0.33326963730653125
Learning rate after epoch 3: [0.00014505153386332084]
Epoch 4/14: 100%|██████████| 4500/4500 [01:08<00:00, 65.67batch/s]

Model validation...
100%|██████████| 1125/1125 [00:13<00:00, 85.32batch/s]
[I 2025-06-24 07:40:26,276] Trial 39 pruned.
top1_score    0.866430
top3_score    0.991551
top5_score    0.998394
dtype: float64
valid_loss:  0.32618762964341375
Learning rate after epoch 4: [0.00014505153386332084]



Beste Hyperparameter: {'lr': 3.287960379631763e-05, 'weight_decay': 0.0013201093866817626, 'num_epochs': 25, 'batch_size': 32, 'only_train_classifier': False, 'sched_patience': 4, 'sched_factor': 0.5506939900584097, 'sched_min_lr': 1e-06}
Beste Leistung (Maximale top1_prediction): 0.903468668460846